% Generated by GrindEQ Word-to-LaTeX 
\documentclass{article} %%% use \documentstyle for old LaTeX compilers

\usepackage[english]{babel} %%% 'french', 'german', 'spanish', 'danish', etc.
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{txfonts}
\usepackage{mathdots}
\usepackage[classicReIm]{kpfonts}
\usepackage[dvips]{graphicx} %%% use 'pdftex' instead of 'dvips' for PDF output

% You can include more LaTeX packages here 


\begin{document}

%\selectlanguage{english} %%% remove comment delimiter ('%') and select language if required


\begin{tabular}{|p{1.4in}|p{1.4in}|p{1.4in}|} \hline 
 &  &  \\ \hline 
\end{tabular}



\begin{tabular}{|p{1.4in}|p{1.4in}|p{1.4in}|} \hline 
 &  &  \\ \hline 
\end{tabular}



\noindent \textbf{C\'{a}c v?n {\dj}? hi?n {\dj}?i c?a c\^{o}ng ngh? th\^{o}ng tin}

\noindent \textbf{Nh\'{o}m 7 : Dafny}

\noindent Contents 

\noindent A. Th\`{a}nh vi\^{e}n 2B. Ph\^{a}n c\^{o}ng c\^{o}ng vi?c 2C. Dafny Tutorial 3I. Guide 31. Introduction 32. Methods 43. Pre- and Postconditions 54. Assertions 75. Functions 76. Loop Invariants // B?t bi?n trong v\`{o}ng l?p 87. Termination\_ T\'{i}nh d?ng 98. Arrays 109. Quantifiers ({\dj}?nh lu?ng) 1110. Predicates 1211. Framing 1312. Binary Search 1413. Conclusion 15II. Dafny -- Termination\_T\'{i}nh d?ng 16III. Dafny - Sets \_ c\'{a}c t?p 19IV. Dafny - Sequences 20V. Dafny -- Collections 241. Sets 242. Sequences 263. Multisets 294. Maps 30VI. Dafny -- Lemmas (B? {\dj}?) 301. Introduction 302. Searching for Zero 313. Lemmas (B? {\dj}?) 324. Counting ({\DJ}?m) 345. Proving the Distributive Property (Ch?ng minh ph\^{a}n ph?i thu?c t\'{i}nh) 356. Induction (C?m ?ng) 377. Paths In a Directed Graph ({\dj}u?ng d?n trong m?t bi?u {\dj}? hu?ng d?n) 38VII. Modules 431. Introduction 432. Declaring New Modules\_ Module m?i 433. Importing and Exporting Modules 444. Opening Modules 485. Module Abstraction 496. Module Ordering and Dependencies 507. Name Resolution 51

\noindent 

\begin{enumerate}
\item  \textbf{Th\`{a}nh vi\^{e}n}
\end{enumerate}

\noindent Th\`{a}nh vi\^{e}n nh\'{o}m 7: 

\begin{enumerate}
\item  Ho\`{a}ng Thanh H?ng

\item  L\^{e} Th? Xu\^{a}n

\item  Ph?m Th? Thu Hu?ng

\item  Ph\`{u}ng Th? Luong
\end{enumerate}

\noindent 

\begin{enumerate}
\item  \textbf{Ph\^{a}n c\^{o}ng c\^{o}ng vi?c}
\end{enumerate}

\begin{tabular}{|p{0.8in}|p{1.2in}|p{2.2in}|} \hline 
\textbf{Tu?n} & \textbf{Th\`{a}nh Vi\^{e}n} & \textbf{C\^{o}ng Vi?c} \\ \hline 
\textbf{1} & Ho\`{a}ng Thanh H?ng & T\`{i}m hi?u ph?n Guide\textbf{} \\ \hline 
\textbf{} & L\^{e} Th? Xu\^{a}n & T\`{i}m hi?u Termination \\ \hline 
\textbf{} & Ph?m Th? Thu Hu?ng & T\`{i}m hi?u Sequences\textbf{} \\ \hline 
\textbf{} & Ph\`{u}ng Th? Luong & T\`{i}m hi?u sets \\ \hline 
\textbf{2} & Ho\`{a}ng Thanh H?ng\textbf{} & T\`{i}m hi?u 6-7 c?a Modules \\ \hline 
\textbf{} & L\^{e} Th? Xu\^{a}n\textbf{} & T\`{i}m hi?u 1-5 c?a Modules, thuy?t tr\`{i}nh \\ \hline 
\textbf{} & Ph?m Th? Thu Hu?ng\textbf{} & T\`{i}m hi?u LemmasCCollections \\ \hline 
\textbf{} & Ph\`{u}ng Th? Luong\textbf{} & T\`{i}m hi?u CollectionsC \\ \hline 
\textbf{3} & Ho\`{a}ng Thanh H?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & L\^{e} Th? Xu\^{a}n\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph?m Th? Thu Hu?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph\`{u}ng Th? Luong\textbf{} & \textbf{} \\ \hline 
\textbf{4} & Ho\`{a}ng Thanh H?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & L\^{e} Th? Xu\^{a}n\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph?m Th? Thu Hu?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph\`{u}ng Th? Luong\textbf{} & \textbf{} \\ \hline 
\textbf{5} & Ho\`{a}ng Thanh H?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & L\^{e} Th? Xu\^{a}n\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph?m Th? Thu Hu?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph\`{u}ng Th? Luong\textbf{} & \textbf{} \\ \hline 
\textbf{6} & Ho\`{a}ng Thanh H?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & L\^{e} Th? Xu\^{a}n\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph?m Th? Thu Hu?ng\textbf{} & \textbf{} \\ \hline 
\textbf{} & Ph\`{u}ng Th? Luong\textbf{} & \textbf{} \\ \hline 
\end{tabular}

\textbf{ }

\noindent \textbf{}

\noindent \textbf{}

\begin{enumerate}
\item \textbf{ Dafny Tutorial}

\item \textbf{ Guide}

\item  Introduction\underbar{}
\end{enumerate}

\underbar{Dafny l\`{a} m?t ng\^{o}n ng? {\dj}u?c thi?t k? gi\'{u}p cho vi?c vi?t code d? d\`{a}ng hon. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a} s? kh\^{o}ng c\`{o}n b?t k? l?i run time n\`{a}o v\`{a} c\~{u}ng {\dj}?ng th?i gi\'{u}p cho l?p tr\`{i}nh vi\^{e}n {\dj}?m b?o ch\'{i}nh x\'{a}c nh?ng g\`{i} h? d? {\dj}?nh l\`{a}m. {\DJ}? l\`{a}m {\dj}u?c {\dj}i?u n\`{a}y, Dafny d?a tr\^{e}n c\'{a}c ch\'{u} th\'{i}ch cao c?p v? l\'{i} do v\`{a} ch?ng minh t\'{i}nh {\dj}\'{u}ng {\dj}?n c?a code. }Hi?u qu? c?a m?t {\dj}o?n m\~{a} c\'{o} th? {\dj}u?c {\dj}ua ra m?t c\'{a}ch tr?u tu?ng, s? d?ng t? nhi\^{e}n, bi?u hi?n c?p cao c?a h\`{a}nh vi mong mu?n, {\dj}\'{o} l\`{a} d? d\`{a}ng hon v\`{a} \'{i}t b? l?i {\dj}? vi?t. Dafny sau {\dj}\'{o} t?o ra m?t b?ng ch?ng cho th?y m\~{a} ph\`{u} h?p v?i c\'{a}c ch\'{u} th\'{i}ch (gi? s? ch\'{u}ng l\`{a} ch\'{i}nh x\'{a}c nh?t, l\`{a} hi?n nhi\^{e}n). Dafny n\^{a}ng cao g\'{a}nh n?ng cho vi?c vi?t m\~{a} l?i mi?n ph\'{i} b?ng c\'{a}ch vi?t ch\'{u} th\'{i}ch kh\^{o}ng c\'{o} l?i. {\DJ}i?u n\`{a}y thu?ng d? hon vi?t code, b?i v\`{i} c\'{a}c ch\'{u} th\'{i}ch ng?n hon v\`{a} tr?c ti?p hon. V\'{i} d?, ph?n m\^{o} t? sau {\dj}\^{a}y trong Dafny n\'{o}i r?ng m?i th\`{a}nh ph?n c?a m?ng {\dj}?u th?a m\~{a}n m?t t\'{i}nh ch?t:

\noindent forall k: int :: 0 $<$= k $<$ a.Length ==$>$ 0 $<$ a[k]

\noindent 

{\DJ}o?n code n\'{o}i r?ng {\dj}?i v?i t?t c? c\'{a}c s? nguy\^{e}n k l\`{a} ch? s? v\`{a}o m?ng, gi\'{a} tr? t?i ch? m?c {\dj}\'{o} l?n hon kh\^{o}ng. B?ng c\'{a}ch vi?t c\'{a}c ch\'{u} th\'{i}ch n\`{a}y, ngu?i ta tin tu?ng r?ng m\~{a} l\`{a} ch\'{i}nh x\'{a}c. Hon n?a, ch\'{i}nh vi?c vi?t c\'{a}c ch\'{u} th\'{i}ch c\'{o} th? gi\'{u}p ngu?i ta hi?u m\~{a} n\`{a}y {\dj}ang l\`{a}m g\`{i} ? m?c s\^{a}u hon.

Ngo\`{a}i ch?ng minh tuong ?ng v?i ch\'{u} th\'{i}ch do ngu?i d\`{u}ng cung c?p, Dafny ch?ng minh r?ng kh\^{o}ng c\'{o} l?i th?i gian ch?y, ch?ng h?n nhu ch? s? ngo\`{a}i ph?m vi, dereferences null, chia cho s? kh\^{o}ng, {\dots}

Dafny c\~{u}ng ch?ng minh vi?c ch?m d?t m\~{a}, ngo?i tr? c\'{a}c v\`{o}ng l?p {\dj}u?c ch? {\dj}?nh {\dj}?c bi?t.

\noindent H\~{a}y b?t {\dj}?u vi?t m?t s? chuong tr\`{i}nh Dafny 

\noindent 

\noindent 

\begin{enumerate}
\item  Methods
\end{enumerate}

Dafny gi?ng nhu m?t ng\^{o}n ng? l?p tr\`{i}nh b?t bu?c {\dj}i?n h\`{i}nh. C\'{o} c\'{a}c phuong ph\'{a}p, bi?n, ki?u, v\`{o}ng l?p, n?u ph\'{a}t bi?u, m?ng, s? nguy\^{e}n, v\`{a} nhi?u hon n?a. M?t trong nh?ng {\dj}on v? co b?n c?a b?t k? chuong tr\`{i}nh Dafny n\`{a}o l\`{a} Methods.  Method l\`{a} m?t {\dj}o?n m\~{a} b?t bu?c {\dj}? th?c thi. Trong c\'{a}c ng\^{o}n ng? kh\'{a}c, ch\'{u}ng c\'{o} th? {\dj}u?c g?i l\`{a} th? t?c, ho?c c\'{a}c ch?c n\u{a}ng, nhung trong Dafny, thu?t ng? "ch?c n\u{a}ng" {\dj}u?c d\`{a}nh ri\^{e}ng cho m?t kh\'{a}i ni?m kh\'{a}c m\`{a} ch\'{u}ng ta s? tr\`{i}nh b\`{a}y sau. Phuong ph\'{a}p {\dj}u?c khai b\'{a}o theo c\'{a}ch sau: 

\noindent method Abs(x: int) returns (y: int)$\{$  y:= 5$\}$

{\DJ}i?u n\`{a}y tuy\^{e}n b? m?t phuong th?c c\'{o} t\^{e}n  g?i l\`{a} "Abs" l?y m?t tham s? s? nguy\^{e}n, {\dj}u?c g?i l\`{a} "x", v\`{a} tr? v? m?t s? nguy\^{e}n duy nh?t, {\dj}u?c g?i l\`{a} "y". Luu \'{y} r?ng c\'{a}c lo?i {\dj}u?c y\^{e}u c?u cho m?i tham s? v\`{a} gi\'{a} tr? tr? v? v\`{a} l\`{a}m theo t?ng t\^{e}n sau d?u hai ch?m (:). Ngo\`{a}i ra, c\'{a}c gi\'{a} tr? tr? l?i {\dj}u?c {\dj}?t t\^{e}n, v\`{a} c\'{o} th? c\'{o} nhi?u gi\'{a} tr? tr? l?i, nhu trong du?i {\dj}\^{a}y:

\noindent method MultipleReturns(x: int, y: int) returns (more: int, less: int)$\{$   more := x + y;   less := x - y;   // comments: are not strictly necessary.$\}$

  Dafny kh\^{o}ng s? d?ng "=", m\`{a} l\`{a} ": =". (Th?c ra, nhu Dafny d\`{u}ng "==" cho s? b\`{i}nh {\dj}?ng, kh\^{o}ng s? d?ng m?t k\'{y} hi?u b?ng m?t k\'{y} t? {\dj}?i di?n cho Dafny). C\'{a}c c\^{a}u {\dj}on gi?n ph?i {\dj}u?c theo sau b?i d?u ch?m ph?y v\`{a} kho?ng tr?ng v\`{a} c\'{a}c ch\'{u} th\'{i}ch (// v\`{a} / ** /) b? b? qua. {\DJ}? tr? l?i m?t gi\'{a} tr? t? m?t phuong th?c, gi\'{a} tr? {\dj}u?c g\'{a}n cho m?t trong nh?ng gi\'{a} tr? tr? v? c\'{o} t\^{e}n tru?c khi m?t c\^{a}u l?nh tr? v?. Trong th?c t?, c\'{a}c gi\'{a} tr? tr? l?i ho?t {\dj}?ng r?t gi?ng v?i c\'{a}c bi?n c?c b?, v\`{a} c\'{o} th? {\dj}u?c g\'{a}n cho nhi?u hon m?t l?n. Tuy nhi\^{e}n, c\'{a}c tham s? {\dj}?u v\`{a}o ch? {\dj}u?c {\dj}?c. C\^{a}u l?nh return {\dj}u?c s? d?ng khi ngu?i ta mu?n quay tr? l?i tru?c khi k?t th\'{u}c ph?n th\^{a}n c?a phuong th?c. C\^{a}u l?nh return c\'{o} th? ch? l\`{a} t? kh\'{o}a tr? v? (trong {\dj}\'{o} gi\'{a} tr? hi?n t?i c?a c\'{a}c tham s? ra {\dj}u?c s? d?ng), ho?c ch\'{u}ng c\'{o} th? l?y m?t danh s\'{a}ch c\'{a}c gi\'{a} tr? {\dj}? tr? v?. Ngo\`{a}i ra c\`{o}n c\'{o} c\'{a}c c\^{a}u l?nh ph?c h?p, ch?ng h?n nhu c\^{a}u l?nh if. N?u c\^{a}u l?nh y\^{e}u c?u d?u ngo?c quanh {\dj}i?u ki?n boolean v\`{a} h\`{a}nh {\dj}?ng nhu mong mu?n:

\noindent method Abs(x: int) returns (y: int)$\{$   if x $<$ 0      $\{$ return -x; $\}$   else      $\{$ return x; $\}$$\}$

M?t luu \'{y} l\`{a} h? lu\^{o}n c?n c\u{a}c d?u ngo?c nh?n $\{$$\}$ cho c\'{a}c kh?i l?nh ? c\'{a}c nh\'{a}nh, ngay c? khi nh\'{a}nh ch? ch?a m?t l?nh duy nh?t . ? {\dj}\^{a}y c\^{a}u l?nh if ki?m tra xem x c\'{o} nh? hon kh\^{o}ng, s? d?ng c\'{u} ph\'{a}p c?a to\'{a}n t? so kh?p quen thu?c v\`{a} tr? v? gi\'{a} tr? tuy?t {\dj}?i n?u th\'{i}ch h?p. (C\'{a}c to\'{a}n t? so s\'{a}nh kh\'{a}c l\`{a} $<$=,$>$, $<$=,! = v\`{a} ==, c\'{o} \'{y} ngh\~{i}a nhu trong c\'{a}c ng\^{o}n ng? l?p tr\`{i}nh)



\begin{enumerate}
\item  Pre- and Postconditions
\end{enumerate}

S?c m?nh th?c s? c?a {\DJ}?i Ph\'{a}p b?t ngu?n t? kh? n\u{a}ng ch\'{u} th\'{i}ch c\'{a}c phuong ph\'{a}p n\`{a}y {\dj}? x\'{a}c {\dj}?nh h\`{a}nh vi c?a h?. V\'{i} d?, m?t thu?c t\'{i}nh m\`{a} ch\'{u}ng ta quan s\'{a}t v?i phuong ph\'{a}p Abs l\`{a} k?t qu? lu\^{o}n lu\^{o}n l?n hon ho?c b?ng kh\^{o}ng, b?t k? {\dj}?u v\`{a}o. Ch\'{u}ng ta c\'{o} th? {\dj}ua quan s\'{a}t n\`{a}y v\`{a}o nh?n x\'{e}t, nhung sau {\dj}\'{o} ch\'{u}ng ta s? kh\^{o}ng c\'{o} c\'{a}ch n\`{a}o {\dj}? bi?t li?u phuong ph\'{a}p c\'{o} th?c s? c\'{o} thu?c t\'{i}nh n\`{a}y hay kh\^{o}ng. Hon n?a, n?u c\'{o} ai {\dj}\'{o} {\dj}?n v\`{a} thay {\dj}?i phuong ph\'{a}p, ch\'{u}ng t\^{o}i s? kh\^{o}ng {\dj}u?c b?o {\dj}?m r?ng b\`{i}nh lu?n {\dj}\~{a} {\dj}u?c thay {\dj}?i {\dj}? ph\`{u} h?p. V?i ch\'{u} th\'{i}ch, ch\'{u}ng t\^{o}i c\'{o} th? c\'{o} Dafny ch?ng minh r?ng t\`{a}i s?n m\`{a} ch\'{u}ng t\^{o}i tuy\^{e}n b? v? phuong ph\'{a}p l\`{a} {\dj}\'{u}ng. C\'{o} m?t s? c\'{a}ch {\dj}? {\dj}ua ra ch\'{u} th\'{i}ch, nhung m?t s? ph? bi?n nh?t, v\`{a} co b?n nh?t l\`{a} c\'{a}c phuong ph\'{a}p tru?c v\`{a} sau h?u {\dj}i?u ki?n.

   t\'{i}nh c?a phuong th?c Abs, m\`{a} k?t qu? lu\^{o}n lu\^{o}n kh\^{o}ng \^{a}m, l\`{a} m?t v\'{i} d? c?a m?t h?u {\dj}i?u ki?n: {\dj}\'{o} l\`{a} c\'{a}i g\`{i} {\dj}\'{o} {\dj}\'{u}ng sau khi phuong ph\'{a}p tr? v?. C\'{a}c h?u {\dj}i?u ki?n, khai b\'{a}o v?i t? kh\'{o}a {\dj}?m b?o, {\dj}u?c {\dj}ua ra nhu l\`{a} m?t ph?n c?a khai b\'{a}o c?a phuong ph\'{a}p, sau c\'{a}c gi\'{a} tr? tr? l?i (n?u c\'{o}) v\`{a} tru?c co th? phuong ph\'{a}p. T? kh\'{o}a {\dj}u?c theo sau b?i bi?u th?c boolean. Gi?ng nhu {\dj}i?u ki?n v\`{a} trong h?u h?t c\'{a}c {\dj}i?u ki?n, {\dj}i?u ki?n h?u {\dj}i?u ki?n lu\^{o}n lu\^{o}n l\`{a} m?t bi?u th?c boolean: c\'{a}i g\`{i} {\dj}\'{o} c\'{o} th? {\dj}\'{u}ng ho?c sai. Trong tru?ng h?p c?a phuong ph\'{a}p Abs, m?t h?u {\dj}i?u ki?n h?p l\'{y} l\`{a} nhu sau:

\noindent method Abs(x: int) returns (y: int)   ensures 0 $<$= y$\{$   ...$\}$

B?n c\'{o} th? th?y t?i sao gi\'{a} tr? tr? l?i {\dj}u?c {\dj}?t t\^{e}n. {\DJ}i?u n\`{a}y l\`{a}m cho ch\'{u}ng d? d\`{a}ng tham kh?o trong h?u {\dj}i?u ki?n c?a m?t phuong ph\'{a}p. Khi bi?u th?c l\`{a} {\dj}\'{u}ng, ch\'{u}ng ta n\'{o}i r?ng c\'{a}c h?u {\dj}i?u ki?n {\dj}u?c  n?m gi?. {\DJ}i?u ki?n h?u {\dj}i?u ki?n ph?i {\dj}u?c gi? cho m?i l?n g?i h\`{a}m, v\`{a} cho m?i {\dj}i?m tr? v? c\'{o} th? x?y ra (bao g?m c? {\dj}i?m ti?m ?n ? cu?i c?a h\`{a}m ch?c n\u{a}ng). Trong tru?ng h?p n\`{a}y, thu?c t\'{i}nh duy nh?t m\`{a} ch\'{u}ng ta {\dj}ang di?n {\dj}?t l\`{a} gi\'{a} tr? tr? v? lu\^{o}n \'{i}t nh?t b?ng kh\^{o}ng.

\begin{enumerate}
\item  \textbf{Pre : }requires {\dj}i?u ki?n  ({\DJ}i?u ki?n tru?c)

\item  \textbf{Post} :ensures {\dj}i?u ki?n ({\DJ}i?u ki?n sau) 
\end{enumerate}

Ch\'{u}ng ta c\'{o} th? k?t h?p hai {\dj}i?u ki?n c\`{u}ng v?i to\'{a}n t? boolean v\`{a} operator (\&\&), ho?c ch\'{u}ng ta c\'{o} th? vi?t nhi?u {\dj}?m b?o c\'{a}c th\^{o}ng s? k? thu?t 

\noindent method MultipleReturns(x: int, y: int) returns (more: int, less: int)    ensures less $<$ x   ensures x $<$ more

\begin{enumerate}
\item  c\'{a}ch vi?t kh\'{a}c l\`{a} : ensures less $<$ x \&\& x $<$ more

\item  Ta c\'{o} v\'{i} d? : $\{$   more := x + y;   less := x - y;$\}$

\item  C\'{a}i n\`{a}y b? sai v\`{i} c\'{o} th? sau h\`{a}m less kh\^{o}ng nh? hon X c\~{u}ng nhu more k l?n hon x (VD y=0)

\item  {\dj}? {\dj}\'{u}ng , th\^{e}m preconditions:  requires y$>$0 tru?c ensures less $<$ x l\`{a} {\dj}u?c
\end{enumerate}

Gi?ng nhu {\dj}i?u ki?n h?u, nhi?u {\dj}i?u ki?n ti\^{e}n quy?t c\'{o} th? {\dj}u?c vi?t b?ng to\'{a}n t? boolean v\`{a} (\&\&), ho?c b?ng nhi?u t? kh\'{o}a.  V?i vi?c b? sung c\'{a}c {\dj}i?u ki?n n\`{a}y, Dafny b\^{a}y gi? x\'{a}c minh m\~{a} l\`{a} ch\'{i}nh x\'{a}c, b?i v\`{i} gi? {\dj}?nh n\`{a}y l\`{a} t?t c? nh?ng g\`{i} c?n thi?t {\dj}? {\dj}?m b?o m\~{a} trong co th? phuong ph\'{a}p l\`{a} ch\'{i}nh x\'{a}c.

\noindent Kh\^{o}ng ph?i code n\`{a}o c\~{u}ng c?n ti?n {\dj}i?u ki?n, nhung n\'{o} c?n c\'{o} m?t ch\'{u}       th\'{i}ch , kh?ng {\dj}?nh {\dj}? x\'{a}c minh, nhu trong v\'{i} d? sau 

\noindent method Max(a: int, b:int) returns (c: int)

\noindent    ensures a$<$=c \&\& b$<$=c 

\noindent $\{$ if a$>$b

\noindent   $\{$return a;$\}$

\noindent   else 

\noindent   $\{$return b;$\}$

\noindent $\}$

\noindent 

\begin{enumerate}
\item  Assertions
\end{enumerate}

Kh\^{o}ng gi?ng ti?n v\`{a} h?u {\dj}i?u ki?n, m?t kh?ng {\dj}?nh {\dj}u?c {\dj}?t ? {\dj}\^{a}u {\dj}\'{o} ? gi?a m?t phuong ph\'{a}p. Gi?ng nhu hai ch\'{u} th\'{i}ch tru?c {\dj}\'{o}, kh?ng {\dj}?nh c\'{o} t? kho\'{a}, kh?ng {\dj}?nh, ti?p theo l\`{a} bi?u th?c boolean v\`{a} d?u ch?m ph?y ch?m d?t c\^{a}u l?nh {\dj}on gi?n. M?t kh?ng {\dj}?nh n\'{o}i r?ng m?t bi?u th?c c? th? lu\^{o}n lu\^{o}n gi? khi ki?m so\'{a}t {\dj}?t {\dj}?n ph?n {\dj}\'{o} c?a code. V\'{i} d? {\dj}o?n code sau

\noindent method Testing()$\{$   assert 2 $<$ 3;$\}$

\noindent 

\noindent =$>$ assert {\dj}i?u ki?n {\dj}? ki?m tra xem {\dj}i?u ki?n test {\dj}\~{a} {\dj}\'{u}ng chua

\noindent VD : asset 2$<$ 3 =$>$ {\dj}\'{u}ng

\noindent Assert 2=3 =$>$ b\'{a}o b? l?i

\noindent \textbf{=$\boldsymbol{>}$ Theo kinh nghi?m c\'{a}i n\`{a}y r?t h?u \'{i}ch , v\`{a} n\^{e}n c\'{o} cho m?i b\`{a}i test}

\begin{enumerate}
\item \textbf{ }Functions

\item  Khai b\'{a}o bi?n :
\end{enumerate}

\noindent var x, y, z: bool := 1, 2, true;

\noindent var x: nat := 5;  // nat l\`{a} ki?u s? nguy\^{e}n kh\^{o}ng \^{a}m 

\begin{enumerate}
\item  VD :
\end{enumerate}

\noindent  function abs(x: int): int$\{$

\noindent if x $<$ 0 then -x else x

\noindent $\}$

\noindent =$>$ h\`{a}m tr? v? tr? tuy?t {\dj}?i c?a x v\`{a} d? li?u tr? v? l\`{a} ki?u int

R\~{o} r\`{a}ng, {\dj}i?u ki?n ph?i l\`{a} m?t bi?u th?c boolean, v\`{a} hai nh\'{a}nh ph?i c\'{o} c\`{u}ng m?t lo?i. B?n c\'{o} th? t? h?i t?i sao m?i ngu?i s? b?n t\^{a}m v?i c\'{a}c ch?c n\u{a}ng, n?u ch\'{u}ng b? h?n ch? so v?i c\'{a}c phuong ph\'{a}p s? k? thu?t. 

\begin{enumerate}
\item  \textbf{G?i h\`{a}m :}
\end{enumerate}

\noindent  function max(a: int, b: int): int 

\noindent $\{$

\noindent    if a$>$b then a else b

\noindent $\}$

\noindent method Testing() $\{$

\noindent assert max(1,2)== 2;

\noindent $\}$

\begin{enumerate}
\item  Loop Invariants (B?t bi?n trong v\`{o}ng l?p)
\end{enumerate}

Khi m\`{a} ch?y m?t v\`{o}ng l?p, Dafny s? kh\^{o}ng bi?t r\~{o} s? l?n v\`{o}ng l?p ch?y, m\`{a} Dafny c?n ph?i xem x\'{e}t t?t c? c\'{a}c con {\dj}u?ng th\^{o}ng qua 1 chu?ng tr\`{i}nh. Do {\dj}\'{o}, khi l\`{a}m vi?c v?i  m?t v\`{o}ng l?p, ta c?n cung c?p m?t {\dj}?i lu?ng ({\dj}i?u ki?n )b?t bi?n (Kh\^{o}ng thay {\dj}?i trong to\`{a}n b? qu\'{a} tr\`{i}nh l?p)

T? kh\'{o}a Khai b\'{a}o invariant {\dj}i?u ki?n











\begin{enumerate}
\item  VD  
\end{enumerate}

\noindent var i := 0;   while i $<$ n      invariant 0 $<$= i    $\{$      i := i + 1;   $\}$

Khi b?n ch? {\dj}?nh m?t bi?n b?t bi?n, Dafny ch?ng minh hai {\dj}i?u: invariant gi? khi nh?p v\`{o}ng l?p, v\`{a} n\'{o} {\dj}u?c b?o v? b?i v\`{o}ng l?p. B?ng c\'{a}ch b?o to\`{a}n, ch\'{u}ng ta c\'{o} ngh\~{i}a l\`{a} gi? {\dj}?nh r?ng bi?n b?t bi?n gi? ? {\dj}?u v\`{o}ng l?p, ch\'{u}ng ta ph?i ch?ng minh r?ng vi?c th?c hi?n co th? v\`{o}ng l?p m?t l?n l\`{a}m cho b?t bi?n gi? l?i. Dafny ch? c\'{o} th? bi?t {\dj}u?c khi ph\^{a}n t\'{i}ch co th? v\`{o}ng l?p m\`{a} c\'{a}c bi?n b?t bi?n n\'{o}i, ngo\`{a}i s? b?o v? v\`{o}ng l?p ({\dj}i?u ki?n v\`{o}ng l?p). Gi?ng nhu Dafny s? kh\^{o}ng kh\'{a}m ph\'{a} {\dj}u?c c\'{a}c thu?c t\'{i}nh c?a m?t phuong ph\'{a}p ri\^{e}ng, n\'{o} s? kh\^{o}ng bi?t b?t k? thu?c t\'{i}nh co b?n nh?t c?a m?t v\`{o}ng l?p {\dj}u?c b?o to\`{a}n tr? khi n\'{o} {\dj}u?c n\'{o}i qua m?t bi?n b?t bi?n.

M?t trong nh?ng v?n {\dj}? khi s? d?ng c\'{a}c bi?n th? b?t bi?n l\`{a} d? d\`{a}ng qu\^{e}n r?ng v\`{o}ng l?p th?c hi?n ti?n b?, ngh\~{i}a l\`{a} l\`{a}m vi?c ? t?ng bu?c. V\'{i} d?, ch\'{u}ng ta c\'{o} th? {\dj}\~{a} b? qua to\`{a}n b? co th? c?a v\`{o}ng l?p trong chuong tr\`{i}nh tru?c {\dj}\'{o}. C\'{a}c bi?n b?t bi?n s? {\dj}\'{u}ng, b?i v\`{i} ch\'{u}ng v?n c\`{o}n {\dj}\'{u}ng khi nh?p v\`{o}ng l?p, v\`{a} v\`{i} v\`{o}ng l?p kh\^{o}ng thay {\dj}?i b?t c? {\dj}i?u g\`{i}, ch\'{u}ng s? {\dj}u?c b?o v? b?i v\`{o}ng l?p. Nhung bu?c quan tr?ng t? v\`{o}ng l?p {\dj}?n h?u {\dj}i?u ki?n s? kh\^{o}ng gi?. Ch\'{u}ng ta bi?t r?ng n?u ch\'{u}ng ta tho\'{a}t kh?i v\`{o}ng l?p, th\`{i} ch\'{u}ng ta c\'{o} th? gi? {\dj}?nh s? ph? {\dj}?nh v\`{a} c\'{a}c bi?n b?t bi?n, nhung {\dj}i?u n\`{a}y kh\^{o}ng n\'{o}i g\`{i} v? {\dj}i?u g\`{i} s? x?y ra n?u ch\'{u}ng ta kh\^{o}ng bao gi? tho\'{a}t kh?i v\`{o}ng l?p. V\`{i} v?y, c?n {\dj}?m b?o r?ng v\`{o}ng l?p k?t th\'{u}c ? m?t th?i {\dj}i?m n\`{a}o {\dj}\'{o}, {\dj}i?u n\`{a}y cho ph\'{e}p {\dj}?m b?o {\dj}\'{u}ng {\dj}?n hon nhi?u 

\begin{enumerate}
\item  Termination\_ T\'{i}nh d?ng
\end{enumerate}

Dafny ch?ng minh t\'{i}nh d?ng c?a code, t?c l\`{a} v\`{o}ng l?p s? ko th?c hi?n m\~{a}i m\~{a}i, th\^{o}ng qua vi?c gi?m gi\'{a} tr? c?a bi?n t (bi?n ch\'{u} th\'{i}ch ).

\noindent Dafny ch?ng minh {\dj}u?c t\'{i}nh d?ng trong 2 tru?ng h?p: 

\begin{enumerate}
\item  V\`{o}ng l?p

\item  {\DJ}? quy
\end{enumerate}

\noindent {\DJ}?i v?i bi?n ch\'{u} th\'{i}ch t s? gi?m sau m?i v\`{o}ng l?p ho?c {\dj}? quy.

\noindent {\DJ}?i v?i vi?c x\'{a}c {\dj}?nh c\'{a}c bi?u th?c gi?m th\`{i} c?n x\'{a}c minh:

\begin{enumerate}
\item  Th?c s? gi?m gi\'{a} tr?

\item  C\'{o} gi\'{a} tr? n?m trong kho?ng gi?i h?n n\`{a}o {\dj}\'{o}.

\item  Trong nhi?u tru?ng h?p, 1 gi\'{a} tr? (s? t? nhi\^{e}n v\`{a} s? nguy\^{e}n) gi?m {\dj}i nhung 1 s? th? kh\'{a}c v?n s? d?ng t?t. {\DJ}?i v?i s? nguy\^{e}n r\`{a}ng bu?c m?c {\dj}?nh {\dj}u?c kh?i t?o l\`{a} 0.

\item  VD: S? d?ng h?p l\'{i} bi?u th?c gi?m:
\end{enumerate}

\noindent 

\noindent 

\noindent 

\noindent  while 0 $<$ i      invariant 0 $<$= i      decreases i   $\{$      i := i - 1;   $\}$

\begin{enumerate}
\item  Arrays
\end{enumerate}

T?t c? nh?ng g\`{i} ch\'{u}ng ta {\dj}\~{a} xem x\'{e}t l\`{a} t?t cho c\'{a}c ch?c n\u{a}ng {\dj}on gi?n v\`{a} c\'{a}c b\`{a}i t?p to\'{a}n h?c \'{i}t, nhung n\'{o} th?c s? kh\^{o}ng h?u \'{i}ch cho c\'{a}c chuong tr\`{i}nh th?c s?. Cho {\dj}?n nay ch\'{u}ng ta ch? xem x\'{e}t m?t s? \'{i}t c\'{a}c gi\'{a} tr? t?i m?t th?i {\dj}i?m trong c\'{a}c bi?n {\dj}?a phuong. B\^{a}y gi? ch\'{u}ng ta chuy?n s? ch\'{u} \'{y} c?a ch\'{u}ng ta sang m?ng d? li?u. M?ng {\dj}u?c x\^{a}y d?ng trong m?t ph?n c?a ng\^{o}n ng?, v?i lo?i ri\^{e}ng c?a h?, m?ng $<$T$>$, noi T l\`{a} m?t lo?i kh\'{a}c. B\^{a}y gi? ch\'{u}ng ta ch? xem x\'{e}t m?ng c\'{a}c s? nguy\^{e}n, m?ng $<$int$>$. M?ng c\'{o} th? l\`{a} null, v\`{a} c\'{o} m?t l\~{i}nh v?c x\^{a}y d?ng chi?u d\`{a}i, a.Length. Truy c?p ph?n t? s? d?ng c\'{u} ph\'{a}p chu?n v\`{a} {\dj}u?c l?p ch? m?c t? s? kh\^{o}ng, do {\dj}\'{o}, m?t [3] {\dj}u?c tru?c b?i 3 ph?n t? a [0], a [1], v\`{a} a [2] theo th? t? {\dj}\'{o}. T?t c? c\'{a}c truy c?p m?ng ph?i {\dj}u?c ch?ng minh l\`{a} n?m trong gi?i h?n, l\`{a} m?t ph?n c?a {\dj}?m b?o an to\`{a}n do l?i c?a Dafny. B?i v\`{i} ki?m tra gi?i h?n {\dj}u?c ch?ng minh t?i th?i {\dj}i?m x\'{a}c minh, kh\^{o}ng c?n ph?i ki?m tra th?i gian ch?y. {\DJ}? t?o m?t m?ng m?i, n\'{o} ph?i {\dj}u?c ph\^{a}n b? b?ng t? kho\'{a} m?i, nhung b\^{a}y gi? ch\'{u}ng ta s? ch? l\`{a}m vi?c v?i c\'{a}c phuong th?c l?y m?t m?ng {\dj}u?c ph\^{a}n b? tru?c {\dj}\'{o} l\`{a}m {\dj}?i s?.

\noindent a: array$<$int$>$ : m?ng a c\'{o} ki?u int ,chi?u d\`{a}i m?ng c\'{o} th? = null 

\noindent M?t trong nh?ng {\dj}i?u co b?n nh?t m\`{a} ch\'{u}ng ta c\'{o} th? mu?n l\`{a}m v?i m?t m?ng l\`{a} t\`{i}m ki?m th\^{o}ng qua n\'{o} cho m?t kh\'{o}a c? th? v\`{a} tr? v? ch? m?c c?a m?t noi m\`{a} ch\'{u}ng ta c\'{o} th? t\`{i}m th?y kh\'{o}a n?u n\'{o} t?n t?i.

\begin{enumerate}
\item  V\'{i} d? v? t\`{i}m ki?m key trong m?ng cho tru?c :
\end{enumerate}

\noindent 

\noindent method Find(a: array$<$int$>$, key: int) returns (index: int)

\noindent    requires a != null

\noindent    ensures 0 $<$= index ==$>$ index $<$ a.Length \&\& a[index] == key

\noindent    ensures index $<$ 0 ==$>$ forall k :: 0 $<$= k $<$ a.Length ==$>$ a[k] != key

\noindent $\{$

\noindent    index := 0;

\noindent    while index $<$ a.Length

\noindent       invariant 0 $<$= index $<$= a.Length

\noindent       invariant forall k :: 0 $<$= k $<$ index ==$>$ a[k] != key

\noindent    $\{$

\noindent       if a[index] == key $\{$ return; $\}$

\noindent       index := index + 1;

\noindent    $\}$

\noindent    index := -1;

\noindent $\}$

\begin{enumerate}
\item  Quantifiers ({\dj}?nh lu?ng)
\end{enumerate}

M?t {\dj}?nh lu?ng trong Dafny thu?ng c\'{o} d?ng c?a m?t bi?u th?c forall, c\`{o}n {\dj}u?c g?i l\`{a} {\dj}?nh lu?ng ph?. Nhu t\^{e}n c?a n\'{o} cho th?y, bi?u th?c n\`{a}y l\`{a} {\dj}\'{u}ng n?u m?t s? thu?c t\'{i}nh {\dj}\'{u}ng cho t?t c? c\'{a}c ph?n t? c?a m?t s? t?p. B\^{a}y gi?, ch\'{u}ng ta s? xem x\'{e}t t?p c\'{a}c s? nguy\^{e}n. M?t v\'{i} d? v? {\dj}?nh lu?ng ph?, trong m?t kh?ng {\dj}?nh, {\dj}u?c {\dj}ua ra du?i {\dj}\^{a}y:

\noindent   assert forall k :: k $<$ k + 1;

\noindent 

{\DJ}?nh lu?ng s? gi?i thi?u m?t t\^{e}n t?m th?i cho m?i ph?n t? c?a t?p m\`{a} n\'{o} {\dj}ang xem x\'{e}t. {\DJ}i?u n\`{a}y {\dj}u?c g?i l\`{a} bi?n r\`{a}ng bu?c, trong tru?ng h?p n\`{a}y l\`{a} k. Bi?n r\`{a}ng bu?c c\'{o} m?t lo?i, m\`{a} h?u nhu lu\^{o}n lu\^{o}n {\dj}u?c suy lu?n hon l\`{a} {\dj}u?c {\dj}ua ra m?t c\'{a}ch r\~{o} r\`{a}ng v\`{a} thu?ng int anyway. . M?t c?p d?u hai ch?m (: :) t\'{a}ch bi?t r\`{a}ng bu?c v\`{a} lo?i t\`{u}y ch?n c?a n\'{o} kh?i thu?c t\'{i}nh {\dj}?nh lu?ng (ph?i l\`{a} ki?u bool). Trong tru?ng h?p n\`{a}y, thu?c t\'{i}nh l\`{a} th\^{e}m v\`{a}o m?t s? nguy\^{e}n n\`{a}o {\dj}\'{o} l\`{a}m cho m?t s? nguy\^{e}n l?n hon. Dafny c\'{o} th? t? {\dj}?ng x\'{a}c minh t\'{i}nh n\u{a}ng n\`{a}y. N\'{o}i chung n\'{o} kh\^{o}ng ph?i l\`{a} r?t h?u \'{i}ch {\dj}? {\dj}?nh lu?ng qua b? v\^{o} h?n, ch?ng h?n nhu t?t c? c\'{a}c s? nguy\^{e}n. Thay v\`{a}o {\dj}\'{o}, {\dj}?nh lu?ng thu?ng {\dj}u?c s? d?ng {\dj}? {\dj}?nh lu?ng tr\^{e}n t?t c? c\'{a}c ph?n t? trong m?t m?ng ho?c c?u tr\'{u}c d? li?u. Ch\'{u}ng ta l\`{a}m {\dj}i?u n\`{a}y cho m?ng b?ng c\'{a}ch s? d?ng to\'{a}n t? ng? \'{y} {\dj}? l\`{a}m cho c\'{a}c thu?c t\'{i}nh {\dj}?nh lu?ng {\dj}\'{u}ng {\dj}?n cho c\'{a}c gi\'{a} tr? kh\^{o}ng ph?i l\`{a} c\'{a}c ch? s?:

\noindent   assert forall k :: 0 $<$= k $<$ a.Length ==$>$ ...a[k]...;

\noindent 

{\DJ}i?u n\`{a}y n\'{o}i r?ng k th?c s? l\`{a} m?t ch? m?c h?p l? c?a m?ng. Dafny th?c t? c\'{o} th? s? kh\^{o}ng ch? {\dj}? ch?ng minh r?ng m?ng {\dj}u?c truy c?p m?t c\'{a}ch an to\`{a}n m\`{a} c\`{o}n gi?m t?p c\'{a}c s? nguy\^{e}n m\`{a} n\'{o} ph?i xem x\'{e}t ch? l\`{a} c\'{a}c ch? s? c\'{o} trong c\'{a}c m?ng.

\noindent V?i m?t {\dj}?nh lu?ng sau, vi?c ch?ng minh m?t ph?n t? kh\^{o}ng ? trong m?ng l\`{a} {\dj}on gi?n :

\noindent forall k :: 0 $<$= k $<$ a.Length ==$>$ a[k] != key

\noindent 

\noindent \textbf{BT: T\`{i}m ph?n t? l?n nh?t trong m?ng (Chua l\`{a}m {\dj}u?c)}

M?t t\`{i}m ki?m tuy?n t\'{i}nh kh\^{o}ng ph?i l\`{a} r?t hi?u qu?, {\dj}?c bi?t l\`{a} khi nhi?u truy v?n {\dj}u?c l\`{a}m b?ng c\`{u}ng m?t d? li?u. N?u m?ng {\dj}u?c s?p x?p, th\`{i} ch\'{u}ng ta c\'{o} th? s? d?ng th? t?c t\`{i}m ki?m nh? ph\^{a}n r?t hi?u qu? {\dj}? t\`{i}m kho\'{a}. Nhung {\dj}? ch\'{u}ng t\^{o}i c\'{o} th? ch?ng minh vi?c th?c hi?n ch\'{i}nh x\'{a}c c?a ch\'{u}ng t\^{o}i, ch\'{u}ng t\^{o}i c?n m?t s? c\'{a}ch {\dj}? y\^{e}u c?u r?ng m?ng {\dj}?u v\`{a}o th?c s? {\dj}u?c s?p x?p. Ch\'{u}ng ta c\'{o} th? l\`{a}m {\dj}i?u n\`{a}y tr?c ti?p v?i m?t b? {\dj}?nh lu?ng b\^{e}n trong m?t m?nh {\dj}? {\dj}\`{o}i h?i c?a phuong ph\'{a}p c?a ch\'{u}ng ta, nhung m?t c\'{a}ch m\^{o} {\dj}un hon {\dj}? di?n t? {\dj}i?u n\`{a}y l\`{a} th\^{o}ng qua m?t v? t?.



\begin{enumerate}
\item  Predicates\underbar{}
\end{enumerate}

M?t predicate l\`{a} m?t h\`{a}m tr? v? m?t boolean. {\DJ}\'{o} l\`{a} m?t \'{y} tu?ng {\dj}on gi?n nhung m?nh m? x?y ra trong c\'{a}c chuong tr\`{i}nh c?a Dafny. V\'{i} d?, ch\'{u}ng ta {\dj}?nh ngh\~{i}a v? t? {\dj}u?c s?p x?p tr\^{e}n c\'{a}c m?ng s? nguy\^{e}n nhu m?t h\`{a}m l?y m?ng l\`{a}m {\dj}?i s?, v\`{a} tr? v? true n?u v\`{a} ch? n?u m?ng {\dj}\'{o} {\dj}u?c s?p x?p theo th? t? ng\`{a}y c\`{a}ng t\u{a}ng. Vi?c s? d?ng c\'{a}c v? t? l\`{a}m cho m\~{a} c?a ch\'{u}ng ta ng?n hon, v\`{i} ch\'{u}ng ta kh\^{o}ng c?n ph?i vi?t ra qu\'{a} d\`{a}i. N\'{o} c\~{u}ng c\'{o} th? l\`{a}m cho m\~{a} c?a ch\'{u}ng ta d? d\`{a}ng hon {\dj}? {\dj}?c b?ng c\'{a}ch cho m?t t\`{a}i s?n chung m?t c\'{a}i t\^{e}n.

\noindent C\'{o} m?t s? c\'{a}ch ch\'{u}ng ta c\'{o} th? vi?t c\'{a}c v? t? {\dj}u?c s?p x?p, nhung c\'{a}ch d? nh?t l\`{a} s? d?ng m?t {\dj}?nh lu?ng tr\^{e}n c\'{a}c ch? s? c?a m?ng. Ch\'{u}ng ta c\'{o} th? vi?t m?t {\dj}?nh lu?ng th? hi?n thu?c t\'{i}nh, "n?u x l\`{a} tru?c y trong m?ng, th\`{i} x $<$= y", nhu l\`{a} m?t {\dj}?nh lu?ng tr\^{e}n hai bi?n r\`{a}ng bu?c:

\noindent    forall j, k :: 0 $<$= j $<$ k $<$ a.Length ==$>$ a[j] $<$= a[k]

\noindent 

? {\dj}\^{a}y ch\'{u}ng ta c\'{o} hai bi?n r\`{a}ng bu?c, j v\`{a} k, c? hai s? nguy\^{e}n. S? so s\'{a}nh gi?a hai s? {\dj}?m b?o r?ng c? 2 l\`{a} ch? s? h?p l? v\`{a}o m?ng, v\`{a} j l\`{a} tru?c k. S. {\DJ}?nh lu?ng ch? l\`{a} m?t lo?i bi?u th?c c\'{o} gi\'{a} tr? boolean ? Dafny, v\`{i} v?y ch\'{u}ng ta c\'{o} th? vi?t c\'{a}c v? t? {\dj}u?c s?p x?p nhu sau: 

\begin{enumerate}
\item  \textbf{V\'{i} d? 1(L?i- s? {\dj}u?c s?a ? Framing)}
\end{enumerate}

\noindent predicate sorted(a: array$<$int$>$)   requires a != null$\{$   forall j, k :: 0 $<$= j $<$ k $<$ a.Length ==$>$ a[j] $<$= a[k]$\}$

\noindent 

Luu \'{y} r?ng kh\^{o}ng c\'{o} ki?u tr? v?, b?i v\`{i} c\'{a}c v? t? lu\^{o}n tr? v? m?t boolean.Dafny t? ch?i m\~{a} n\`{a}y nhu {\dj}\~{a} cho, tuy\^{e}n b? r?ng v? t? kh\^{o}ng th? {\dj}?c m?ng a . Kh?c ph?c v?n {\dj}? n\`{a}y y\^{e}u c?u ch\'{u} th\'{i}ch kh\'{a}c, {\dj}?c ch\'{u} th\'{i}ch.



\begin{enumerate}
\item  Framing 
\end{enumerate}

V? t? {\dj}u?c s?p x?p kh\^{o}ng th? truy c?p m?ng v\`{i} m?ng kh\^{o}ng {\dj}u?c bao g?m trong Frame c?a h\`{a}m. Frame {\dj}?c c?a m?t ch?c n\u{a}ng (ho?c v? t?) l\`{a} t?t c? c\'{a}c v? tr\'{i} b? nh? m\`{a} ch?c n\u{a}ng {\dj}u?c ph\'{e}p {\dj}?c. L\'{y} do ch\'{u}ng ta c\'{o} th? h?n ch? m?t ch?c n\u{a}ng c\'{o} th? {\dj}?c hay kh\^{o}ng l\`{a} khi ch\'{u}ng ta ghi v\`{a}o b? nh?, ch\'{u}ng ta c\'{o} th? ch?c ch?n r?ng c\'{a}c h\`{a}m kh\^{o}ng {\dj}?c ph?n b? nh? {\dj}\'{o} c\'{o} c\`{u}ng gi\'{a} tr? m\`{a} ch\'{u}ng {\dj}\~{a} l\`{a}m tru?c {\dj}\'{o}. V\'{i} d?, ch\'{u}ng ta c\'{o} th? c\'{o} hai m?ng, m?t trong s? ch\'{u}ng, ta bi?t {\dj}u?c s?p x?p. N?u ch\'{u}ng ta kh\^{o}ng {\dj}?t ch\'{u} th\'{i}ch cho thu?c t\'{i}nh {\dj}u?c s?p x?p, th\`{i} khi ch\'{u}ng ta s?a {\dj}?i m?ng chua {\dj}u?c ph\^{a}n lo?i, ch\'{u}ng ta kh\^{o}ng th? x\'{a}c {\dj}?nh li?u m?ng kh\'{a}c {\dj}\~{a} ng?ng s?p x?p hay kh\^{o}ng. M?c d\`{u} ch\'{u}ng ta c\'{o} th? cung c?p c\'{a}c bi?n {\dj}?i b?t bi?n {\dj}? b?o to\`{a}n n\'{o} trong tru?ng h?p n\`{a}y, n\'{o} th?m ch\'{i} c\`{o}n ph?c t?p hon khi thao t\'{a}c c\'{a}c c?u tr\'{u}c d? li?u. Trong tru?ng h?p n\`{a}y, Frame l\`{a} r?t c?n thi?t {\dj}? l\`{a}m cho qu\'{a} tr\`{i}nh x\'{a}c minh kh? thi.

\noindent L?nh cho ph\'{e}p {\dj}?c : reads

\noindent 

\noindent 

\noindent 

\noindent Ch?a v\'{i} d? 1 ? m?c 10 :

\noindent predicate sorted(a: array$<$int$>$)   requires a != null

\noindent    reads a$\{$   forall j, k :: 0 $<$= j $<$ k $<$ a.Length ==$>$ a[j] $<$= a[k]$\}$

\noindent 

\noindent  v?y s? kh\^{o}ng b? l?i kh\^{o}ng {\dj}?c {\dj}u?c m?ng a n?a

Ch\'{u} th\'{i}ch ghi ch\'{u} {\dj}?c m?ng a kh\^{o}ng ph?i l\`{a} m?t bi?u th?c boolean, gi?ng nhu c\'{a}c ch\'{u} th\'{i}ch kh\'{a}c ch\'{u}ng ta {\dj}\~{a} th?y, v\`{a} c\'{o} th? xu?t hi?n ? b?t c? {\dj}\^{a}u c\`{u}ng v?i c\'{a}c {\dj}i?u ki?n tru?c v\`{a} sau h?u {\dj}i?u ki?n. Thay v\`{i} thu?c t\'{i}nh c?n ph?i {\dj}\'{u}ng, n\'{o} ch? {\dj}?nh m?t t?p h?p c\'{a}c v? tr\'{i} b? nh? m\`{a} h\`{a}m {\dj}u?c ph\'{e}p truy c?p. T\^{e}n c?a m?t m?ng, nhu trong v\'{i} d? tr\^{e}n, l\`{a} vi?t t?t c?a t?t c? c\'{a}c ph?n t? c?a m?ng {\dj}\'{o}. M?t c\~{u}ng c\'{o} th? ch? {\dj}?nh c\'{a}c tru?ng {\dj}?i tu?ng v\`{a} c\'{a}c {\dj}?i tu?ng, nhung ch\'{u}ng ta s? kh\^{o}ng quan t\^{a}m {\dj}?n nh?ng ch? {\dj}? {\dj}\'{o} ? {\dj}\^{a}y. Dafny s? ki?m tra xem b?n kh\^{o}ng {\dj}?c b?t k? v? tr\'{i} b? nh? n\`{a}o kh\^{o}ng {\dj}u?c n\^{e}u trong khung {\dj}?c. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a} c\'{a}c cu?c g?i h\`{a}m trong m?t h\`{a}m ph?i c\'{o} khung {\dj}?c. M?t {\dj}i?u c?n luu \'{y} l\`{a} c\'{a}c tham s? cho c\'{a}c ch?c n\u{a}ng kh\^{o}ng ph?i l\`{a} v? tr\'{i} b? nh? kh\^{o}ng c?n ph?i {\dj}u?c khai b\'{a}o.

Khung c\~{u}ng ?nh hu?ng {\dj}?n c\'{a}c Methods. Nhu b?n c\'{o} th? {\dj}o\'{a}n, ch\'{u}ng kh\^{o}ng b?t bu?c ph?i li?t k\^{e} nh?ng th? h? {\dj}?c, v\`{i} ch\'{u}ng ta {\dj}\~{a} vi?t m?t phuong th?c truy xu?t m?t m?ng kh\^{o}ng c\'{o} ch\'{u} th\'{i}ch. C\'{a}c phuong ph\'{a}p {\dj}u?c ph\'{e}p {\dj}?c b?t k? b? nh? n\`{a}o m\`{a} h? th\'{i}ch, nhung ch\'{u}ng {\dj}u?c y\^{e}u c?u li?t k\^{e} nh?ng ph?n b? nh? m\`{a} ch\'{u}ng s?a {\dj}?i, v?i m?t s?a {\dj}?i ch\'{u} th\'{i}ch. H? g?n nhu gi?ng h?t v?i ngu?i h? h\`{a}ng c?a h? {\dj}?c, ngo?i tr? h? n\'{o}i nh?ng g\`{i} c\'{o} th? {\dj}u?c thay {\dj}?i, ch? kh\^{o}ng ph?i l\`{a} nh?ng g\`{i} gi\'{a} tr? c?a c\'{a}c ch?c n\u{a}ng ph? thu?c v\`{a}o. K?t h?p v?i c\'{a}c l?n {\dj}?c, c\'{a}c h?n ch? s?a {\dj}?i cho ph\'{e}p Dafny ch?ng minh c\'{a}c thu?c t\'{i}nh c?a m\~{a} m\`{a} n?u kh\^{o}ng s? r?t kh\'{o} kh\u{a}n ho?c kh\^{o}ng th?. {\DJ}?c v\`{a} s?a {\dj}?i l\`{a} m?t trong nh?ng c\^{o}ng c? cho ph\'{e}p Dafny c\'{o} th? l\`{a}m vi?c theo m?t phuong th?c c\`{u}ng m?t l\'{u}c b?i v\`{i} h? h?n ch? nh?ng thay {\dj}?i t\`{u}y \'{y} v? b? nh? {\dj}?i v?i m?t {\dj}i?u m\`{a} Dafny c\'{o} th? gi?i th\'{i}ch.

Luu \'{y} r?ng khung ch? \'{a}p d?ng cho heap, ho?c b? nh? truy c?p th\^{o}ng qua t\`{a}i li?u tham kh?o. C\'{a}c bi?n {\dj}?a phuong kh\^{o}ng {\dj}u?c luu tr? tr\^{e}n {\dj}?ng, v\`{i} v?y ch\'{u}ng kh\^{o}ng th? {\dj}u?c {\dj}? c?p trong ch\'{u} th\'{i}ch. C\~{u}ng luu \'{y} r?ng c\'{a}c lo?i nhu b?, chu?i v\`{a} {\dj}a l?p l\`{a} c\'{a}c ki?u gi\'{a} tr?, v\`{a} {\dj}u?c {\dj}?i x? nhu c\'{a}c s? nguy\^{e}n ho?c bi?n c?c b?. M?ng v\`{a} c\'{a}c {\dj}?i tu?ng l\`{a} c\'{a}c lo?i t\`{a}i li?u tham kh?o, v\`{a} ch\'{u}ng {\dj}u?c luu tr? tr\^{e}n heap (m?c d\`{u} nhu thu?ng th\`{i} c\'{o} m?t s? ph\^{a}n bi?t tinh t? gi?a b?n th\^{a}n tham kh?o v\`{a} gi\'{a} tr? m\`{a} n\'{o} tr? {\dj}?n.)

\begin{enumerate}
\item  Binary Search\underbar{}
\end{enumerate}

\noindent C\'{a}c v? t? thu?ng {\dj}u?c s? d?ng {\dj}? l\`{a}m cho c\'{a}c ch\'{u} th\'{i}ch kh\'{a}c r\~{o} r\`{a}ng hon:

\noindent method BinarySearch(a: array$<$int$>$, key: int) returns (index: int)   requires a != null \&\& sorted(a)   ensures ...$\{$   ...$\}$

Ta c\'{o} h?u {\dj}i?u ki?n tuong t? nhu khi l\`{a}m cho t\`{i}m ki?m tuy?n t\'{i}nh. Nhung kh\'{a}c ? ch? m?ng ban {\dj}?u {\dj}\~{a} {\dj}u?c s?p x?p. Dafny c\'{o} th? m? g\'{o}i function, b\^{e}n trong method n\'{o} c\~{u}ng bi?t.Ta c\'{o} th? s? d?ng n\'{o} {\dj}? ch?ng minh t\'{i}nh ch\'{i}nh x\'{a}c c?a vi?c t\`{i}m ki?m. Ph?n th\^{a}n c?a method {\dj}u?c {\dj}ua ra nhu sau:

\noindent var low, high := 0, a.Length;while low $<$ high      invariant 0 $<$= low $<$= high $<$= a.Length      invariant forall i ::         0 $<$= i $<$ a.Length \&\& !(low $<$= i $<$ high) ==$>$ a[i] != value   $\{$      var mid := (low + high) / 2;      if a[mid] $<$ value      $\{$         low := mid + 1;      $\}$      else if value $<$ a[mid]      $\{$         high := mid;      $\}$      else      $\{$         return mid;      $\}$   $\}$   return -1;

\begin{enumerate}
\item  {\DJ}?u ti\^{e}n khai b\'{a}o ph?m v\`{i} t\`{i}m ki?m, c\'{a}c b?t bi?n {\dj}?u ti\^{e}n cho th?y ph?m vi n?m trong m?ng.

\item  Th? 2 keyword s? kh\^{o}ng n?m ngo\`{a}i ph?m vi tr\^{e}n. Trong 2 nh\'{a}nh (if c?a i) nh?n th?y gi\'{a} tr? ? gi?a kh\^{o}ng ph?i keyword, ti?n h\`{a}nh di chuy?n ph?m vi {\dj}? lo?i tr? n\'{o} v\`{a} x\'{a}c {\dj}?nh b\^{e}n ph\`{u} h?p.Ch\'{u}ng ta c?n b? sung th\^{e}m m?t {\dj}i?m khi di chuy?n {\dj}?u cu?i du?i c?a d?i b?i v\`{i} n\'{o} bao g?m b\^{e}n th?p.

\item  N?u kh\^{o}ng +1 th\`{i} v?ng l?p c\'{o} th? kh\^{o}ng d?ng. {\DJ}? tho\'{a}t kh?i {\dj}i?u n\`{a}y th\`{i} c?n c\'{o} ki?m tra sau 1 v\`{o}ng l?p {\dj}? x\'{a}c {\dj}?nh key n?m ? 1 ch? s? c\`{o}n l?i. Trong c\^{o}ng th?c tr\^{e}n th\`{i} do low==high n\^{e}n v\`{o}ng l?p tho\'{a}t ra, c\'{o} ngh\~{i}a l\`{a} kh\^{o}ng c\'{o} ph?n t? n\`{a}o trong ph?m vi t\`{i}m ki?m, kh\^{o}ng t\`{i}m th?y key. {\DJ}i?u n\`{a}y c\'{o} th? {\dj}u?c suy lu?n t? b?t bi?n v\`{o}ng l?p: 
\end{enumerate}

\noindent  invariant forall i ::               0 $<$= i $<$ a.Length \&\& !(low $<$= i $<$ high) ==$>$ a[i] != value

\begin{enumerate}
\item  Khi low==high ph? nh?n ph?n 1 . B?t bi?n n\'{o}i r?ng t?t c? c\'{a}c y?u t? trong m?ng kh\^{o}ng ph?i key v\`{a} h?u {\dj}i?u ki?n th? 2 n?m gi?.
\end{enumerate}

\noindent \includegraphics*[width=5.02in, height=3.82in, keepaspectratio=false]{image1}

\begin{enumerate}
\item  \underbar{Conclusion}
\end{enumerate}

V?y l\`{a} ch\'{u}ng ta {\dj}\~{a} xem qua m?t lu?t nh?ng g\`{i} m\`{a} Dafny c\'{o} th? l\`{a}m. Tuy nhi\^{e}n, {\dj}? th?c s? t?n d?ng {\dj}u?c s?c m?nh c?a Dafny, b?n c?n ph?i ti?n s\^{a}u v\`{a}o c\'{a}c ch? {\dj}? n\^{a}ng cao: {\dj}?i tu?ng, chu?i v\`{a} t?p h?p, c?u tr\'{u}c d? li?u, lemmas, v.v ... B\^{a}y gi? b?n {\dj}\~{a} quen thu?c v?i nh?ng {\dj}i?u co b?n c?a {\DJ}?i Ph\'{a}p, b?n c\'{o} th? {\dj}?c c\'{a}c hu?ng d?n v? m?i ch? {\dj}? n\`{a}y khi b?n gi?i tr\'{i}. M?i hu?ng d?n {\dj}u?c thi?t k? {\dj}? c\'{o} m?t hu?ng d?n tuong {\dj}?i g?n {\dj}? ch? {\dj}? c?a n\'{o}, m?c d\`{u} m?t s? c\'{o} l?i t? vi?c {\dj}?c nh?ng ngu?i kh\'{a}c tru?c. C\'{a}c v\'{i} d? c\~{u}ng l\`{a} m?t noi t?t {\dj}? t\`{i}m ki?m c\'{a}c chuong tr\`{i}nh m?u Dafny. Cu?i c\`{u}ng, tham kh?o c\'{o} ch?a c\'{a}c chi ti?t gritty c?a Dafny c\'{u} ph\'{a}p v\`{a} ng? ngh\~{i}a, cho khi b?n ch? c?n bi?t nh?ng g\`{i} c\'{a}c nh\`{a} khai th\'{a}c t?p h?p r?i (it's !!, cho nh?ng ngu?i quan t\^{a}m).\underbar{}

Ngay c? khi b?n kh\^{o}ng s? d?ng Dafny thu?ng xuy\^{e}n, \'{y} tu?ng vi?t ra ch\'{i}nh x\'{a}c m\~{a} n\'{o} l\`{a} g\`{i}, v\`{a} s? d?ng m\~{a} n\`{a}y {\dj}? ch?ng minh {\dj}\'{u}ng m\~{a} l\`{a} m?t k? n\u{a}ng h?u \'{i}ch. C\'{a}c bi?n th? b?t bi?n, {\dj}i?u ki?n tru?c v\`{a} sau, v\`{a} ch\'{u} th\'{i}ch r?t h?u \'{i}ch trong g? l?i m\~{a}, v\`{a} c\~{u}ng nhu l\`{a} t\`{a}i li?u cho c\'{a}c nh\`{a} ph\'{a}t tri?n trong tuong lai. Khi s?a {\dj}?i ho?c th\^{e}m v\`{a}o m?t codebase, h? x\'{a}c nh?n r?ng s? {\dj}?m b?o c?a m\~{a} hi?n t?i kh\^{o}ng b? h?ng. H? c\~{u}ng {\dj}?m b?o r?ng API {\dj}u?c s? d?ng {\dj}\'{u}ng c\'{a}ch, b?ng c\'{a}ch ch\'{i}nh th?c h\'{o}a h\`{a}nh vi v\`{a} c\'{a}c y\^{e}u c?u v\`{a} th?c thi vi?c s? d?ng {\dj}\'{u}ng. L\'{y} do t? b?t bi?n, xem x\'{e}t tru?c v\`{a} sau h?u {\dj}i?u ki?n, v\`{a} b?ng v\u{a}n b?n kh?ng {\dj}?nh {\dj}? ki?m tra c\'{a}c gi? {\dj}?nh l\`{a} t?t c? c\'{a}c k? n\u{a}ng khoa h?c m\'{a}y t\'{i}nh n\'{o}i chung s? mang l?i l?i \'{i}ch cho b?n cho d\`{u} b?n l\`{a}m vi?c ? ng\^{o}n ng? n\`{a}o.

\noindent 

\begin{enumerate}
\item  \textbf{Dafny -- Termination\_T\'{i}nh d?ng}
\end{enumerate}

\noindent Dafny ch?ng minh t?t c? chuong tr\`{i}nh {\dj}?u c\'{o} t\'{i}nh d?ng.

\noindent T\'{i}nh d?ng {\dj}u?c ch?ng m\`{i}nh trong 2 tru?ng h?p:

\begin{enumerate}
\item  V\`{o}ng l?p

\item  {\DJ}? quy
\end{enumerate}

K\~{i} thu?t \'{a}p d?ng: Gi?m bi?n t (bi?n ch\'{u} th\'{i}ch cho t\'{i}nh d?ng c?a chuong tr\`{i}nh). Bi?n t l\`{a} bi?n {\dj}u?c quy {\dj}?nh 1 gi\'{a} tr? v\`{a} s? c\'{o} gi\'{a} tr? nh? m?i l?n v\`{o}ng l?p {\dj}i qua ho?c m?i l?n {\dj}? quy. {\DJ}?ng th?i  bi?n t c\'{o} gi\'{a} tr? gi?i h?n {\dj}? n\'{o} kh\^{o}ng gi?m m\~{a}i. V\`{i} t\'{i}nh d?ng c?a bi?n t m\`{a} t ch?ng minh {\dj}u?c chuong tr\`{i}nh c\'{o} t\'{i}nh d?ng. D?n {\dj}?n {\dj}? ch?ng minh t\'{i}nh d?ng c?a chuong tr\`{i}nh, Dafny ch?ng minh bi?n t gi?m sau m?i l?n l?p

Bi?n t: c\'{o} nhi?u lo?i gi\'{a} tr? thu?ng s? d?ng l\`{a} c\'{a}c s? nguy\^{e}n, r\`{a}ng bu?c m?c {\dj}?nh c?a s? nguy\^{e}n l\`{a} 0, v\`{a} vi?c ch?ng minh t\'{i}nh gi?m c?a s? nguy\^{e}n kh\'{a} d? d\`{a}ng.

\begin{enumerate}
\item  VD. V\`{o}ng l?p: 
\end{enumerate}

\noindent while i $<$ n   invariant 0 $<$= i $<$= n$\{$   // do something interesting   i := i + 1;$\}$\textbf{}

\noindent V\`{o}ng l?p n\`{a}y c\'{o} ch?m d?t hay kh\^{o}ng?

\noindent V\`{i} {\dj}\^{a}y l\`{a} 1 v\`{o}ng l?p th\^{o}ng thu?ng, Dafny c\'{o} 1 quy t?c {\dj}?c bi?t {\dj}? {\dj}o\'{a}n bi?n d?ng. Dafny kh\^{o}ng th?y r\~{o} bi?n t v\`{i} v?y n\'{o} {\dj}\~{a} {\dj}o\'{a}n. 

\noindent N\'{o} th?y r?ng {\dj}i?u ki?n v\`{o}ng l?p l\`{a} s? so s\'{a}nh gi\'{a} tr? h\`{i}nh th?c A$<$B n\'{o} {\dj}o\'{a}n {\dj}u?c:

\noindent Gi?m b?t B-A hay trong tru?ng h?p n\`{a}y l\`{a} n-i

\noindent N?u th\^{e}m c\'{a}c ch\'{u} th\'{i}ch n\`{a}y v\`{a}o trong v\`{o}ng l?p th\`{i} Dafny {\dj}? ti?p t?c ki?m ch?ng, {\dj}?n khi t {\dj}u?c gi?i h?n v? 0.

\noindent Ch\'{u}ng ta c\'{o} th? vi?t :

\noindent var i, n := 0, 11;while i $<$ n   decreases n - i$\{$   // do something interesting   i := i + 5;$\}$\textbf{}

? v\`{o}ng l?p cu?i i=15 do {\dj}\'{o} gi\'{a} tr? d?ng l\`{a} -4. Do v\`{o}ng l?p n\`{a}y l\`{a} sai n\^{e}n v\`{o}ng l?p s? kh\^{o}ng th?c hi?n l?i. Luu \'{y} ph?i b? b?t bi?n v\`{o}ng l?p nhu v?y i m?i c\'{o} th? vu?t qua n.

\noindent T\'{i}nh d?ng c?a to\`{a}n b? chuong tr\`{i}nh, kh\^{o}ng ch? v\`{o}ng l?p.

\noindent K\~{i} thu?t s? d?ng:

\begin{enumerate}
\item  Tuong t? tr\^{e}n

\item  N\'{o} ph\^{a}n t\'{i}ch c\'{a}c h\`{a}m v\`{a} phuong ph\'{a}p g?i nhau {\dj}? t\`{i}m {\dj}? quy. 
\end{enumerate}

VD h\`{a}m {\dj}? quy:

function fac(n: nat): nat$\{$   if n == 0 then 1 else n * fac(n-1)$\}$\textbf{}

Dafny ch? ra r?ng {\dj}?i v?i h?u h?t c\'{a}c ch?c n\u{a}ng m\`{a} l\`{a} {\dj}? quy th\`{i} ch? c?n g?i m\`{i}nh voi gi\'{a} tr? nh? hon c?a c\'{a}c th\^{o}ng s? v\`{i} v?y m?c {\dj}?nh {\dj}o\'{a}n {\dj}u?c th\^{o}ng s? gi?m. C\'{o} th? b? sung cho vi?c gi?m ch\'{u} th\'{i}ch:  decreases n {\dj}? khai b\'{a}o h\`{a}m. 

\begin{enumerate}
\item  {\DJ}\^{o}i khi n\'{o} l?i c\'{o} l?i {\dj}? c\'{o} v\`{o}ng l?p kh\^{o}ng d?ng ho?c t\'{i}nh d?ng kh\^{o}ng r\~{o}. 
\end{enumerate}

\noindent VD: trong method sau:

method hail(N: nat)   decreases *$\{$   var n := N;   while 1 $<$ n      decreases *   $\{$      n := if n \% 2 == 0 then n / 2 else n * 3 + 1;   $\}$$\}$\textbf{}

Chuong tr\`{i}nh n\`{a}y ch?m d?t khi v\`{a} ch? khi c\'{a}c ph?ng {\dj}o\'{a}n Collatz l\`{a} s? th?t, song n\'{o} l\`{a} v?n {\dj}? m? trong to\'{a}n h?c n\^{e}n Dafny kh\^{o}ng th?c s? c\'{o} th? ch?ng minh t\'{i}nh d?ng c?a chuong tr\`{i}nh.

\begin{enumerate}
\item  C\'{o} th? m\~{a} h\'{o}a 1 c\'{a}i g\`{i} {\dj}\'{o} gi?ng 1 b? x? l\'{i} d\`{o}ng m\`{a} {\dj}u?c thi?t k? {\dj}? ch?y m\~{a}i m\~{a}i, nhu v?y Dafny s? cung c?p 1 "out" {\dj}? ch? th? cho Dafny kh\^{o}ng n\^{e}n c? g?ng ch?ng minh n?a. N\'{o} {\dj}u?c n\^{e}u ra ? method hail ? tr\^{e}n.

\item  1 method c\'{o} ch?a 1 v\`{o}ng l?p {\dj}u?c {\dj}\'{a}nh d?u b?ng ch\'{i}nh n\'{o} ph?i {\dj}u?c {\dj}\'{a}nh d?u b?ng decreases *
\end{enumerate}

\noindent Dafny c\'{o} th? s? d?ng c\'{a}c gi\'{a} tr? kh\'{a}c s? nguy\^{e}n nhu bi?n ph\'{a}p ch?m d?t. Khi m?t d\~{a}y {\dj}u?c ch? {\dj}?nh Dafny t? {\dj}?ng s? d?ng chi?u d\`{a}i nhu 1 bi?n ph\'{a}p {\dj}? ch?m d?t.

\noindent C\'{a}c t?p h?p {\dj}u?c coi l\`{a} nh? hon n?u m?t t?p con l\`{a} m?t t?p h?p con c?a t?p kia, do {\dj}\'{o}, m?i t?p ph?i {\dj}u?c ch?a trong t?p tru?c.

\noindent V?i c\'{a}c t?p h?p, t?p h?p tr?ng r?ng nh? nhu b?n c\'{o} th? {\dj}i v\`{a} tr\`{i}nh t? c\'{o} {\dj}? d\`{a}i s? t? nhi\^{e}n, n\^{e}n c? 2 c\'{o} gi?i h?n th?p hon. 

\noindent 

\noindent \textbf{VD:} Vi?c th?c hi?n h\`{a}m Ackermann sau {\dj}\^{a}y s? d?ng m?t c?p s? nguy\^{e}n {\dj}? ch?ng minh ch?m d?t:

\noindent function Ack(m: nat, n: nat): nat   decreases m, n$\{$   if m == 0 then n + 1   else if n == 0 then Ack(m - 1, 1)   else Ack(m - 1, Ack(m, n - 1))$\}$\textbf{}

C\'{a}c m?nh {\dj}? gi?m d?n {\dj}u?c vi?t ra r\~{o} r\`{a}ng, Dafny c\'{o} th? d? {\dj}o\'{a}n {\dj}u?c n\'{o}. M?t tuple s? d?ng so s\'{a}nh k\'{i}ch thu?c c?a c\'{a}c gi\'{a} tr? th\`{a}nh ph?n {\dj}? x\'{a}c {\dj}?nh xem c\'{a}c bi?n ph\'{a}p {\dj}\~{a} b? thu h?p. 

N?u ph?n t? {\dj}?u ti\^{e}n, trong tru?ng h?p n\`{a}y m, nh? hon,kh\^{o}ng c\'{o} v?n {\dj}? g\`{i} x?y ra v?i c\'{a}c gi\'{a} tr? kh\'{a}c. H? c\'{o} th? t\u{a}ng, gi?m, ho?c ? l?i nhu nhau. Ph?n t? th? hai ch? {\dj}u?c xem x\'{e}t n?u ph?n t? {\dj}?u ti\^{e}n kh\^{o}ng thay {\dj}?i. Sau {\dj}\'{o}, gi\'{a} tr? th? hai c?n gi?m. N?u kh\^{o}ng, th\`{i} ph?n t? th? ba ph?i gi?m, vv Cu?i c\`{u}ng, m?t trong c\'{a}c y?u t? ph?i gi?m. Qu\'{a} th?i {\dj}i?m {\dj}\'{o}, v\`{a} c\'{a}c y?u t? kh\'{a}c l?i {\dj}u?c t? do {\dj}? t\u{a}ng ho?c l\`{a}m b?t c? {\dj}i?u g\`{i} h? th\'{i}ch.\textbf{}

\noindent Trong ch?c n\u{a}ng Ack, c\'{o} ba cu?c g?i {\dj}? quy. \textbf{}

\begin{enumerate}
\item \textbf{ }Trong l?n {\dj}?u ti\^{e}n, m tr? th\`{a}nh m?t nh? hon, nhung n t\u{a}ng l\^{e}n. {\DJ}i?u n\`{a}y l\`{a} t?t v\`{i} n {\dj}?n sau khi m trong t?p n\`{a}y. 

\item  Trong cu?c g?i th? hai, m gi?m, do {\dj}\'{o}, {\dj}?i s? th? hai {\dj}u?c cho ph\'{e}p l\`{a} b?t k? gi\'{a} tr? n\`{a}o ({\dj}i?u {\dj}\'{o} l\`{a} t?t, b?i v\`{i} Dafny kh\^{o}ng th?c s? ch?ng minh b?t c? $\mathrm{\eth}$i?u g\`{i} v? k?t qu? c?a cu?c g?i {\dj}? quy th? ba). Ngu?i Dafny c?n ph?i ch?ng minh r?ng cu?c g?i th? ba tu\^{a}n th? c\'{a}c bi?n ph\'{a}p ch?m d?t.

\item  {\DJ}?i v?i cu?c g?i n\`{a}y, m v?n gi? nguy\^{e}n, nhung n gi?m, v\`{i} v?y t?ng th? gi?m c\~{u}ng t?t.
\end{enumerate}

\noindent T\'{i}nh d?ng \'{a}p d?ng cho nhi?u {\dj}\^{o}i b\^{e}n c\`{u}ng c\'{o} {\dj}? quy h\`{a}m/ method.

\begin{enumerate}
\item  VD: c?p ch?n l? {\dj}? quy {\dj}u?c x\'{a}c {\dj}?nh:
\end{enumerate}

predicate even(n: nat)   ensures even(n) $<$==$>$ n \% 2 == 0$\{$   if n == 0 then true else odd(n-1)$\}$predicate odd(n: nat)   ensures odd(n) $<$==$>$ n \% 2 != 0$\{$   if n == 0 then false else even(n-1)$\}$\textbf{}

Dafny ch?ng minh r?ng h? ch?m d?t b?ng c\'{a}ch xem x\'{e}t t?t c? c\'{a}c con {\dj}u?ng c\'{o} th? th\^{o}ng qua hai ch?c n\u{a}ng.



\begin{enumerate}
\item  \textbf{Dafny -- Collections}
\end{enumerate}

Lo?i gi\'{a} tr? l\`{a} nh?ng lo?i {\dj}ai di?n m?t s? th\^{o}ng tin m\`{a} kh\^{o}ng ph? thu?c v\`{a}o tr?ng th\'{a}i c?a heap. Nh?ng gi\'{a} tr? n\`{a}y c\'{o} th? nh?n di?n to\'{a}n h?c. ch\'{u}ng kh\^{o}ng th? {\dj}u?c s?a {\dj}?i khi ch\'{u}ng {\dj}u?c t?o ra. V\'{i} d? nhu sequences v\`{a} sets. B?n kh\^{o}ng th? thay {\dj}?i m?t set theo c\'{a}ch m\`{a} b?n s?a {\dj}?i ch? m?c trong m?t m?ng. thay v\`{a}o {\dj}\'{o} {\dj}? th\^{e}m m?t ph?n t? v\`{a}o set, b?n s? x\^{a}y d?ng d?a tr\^{e}n vi?c k?t h?p set g?c v\`{a} set singleton bao g?m ph?n t? m?i. d\~{i} nhi\^{e}n l\`{a} nh?ng ph?n t? c\~{u} v?n t?n t?i xung quanh. Vi?c thi?u s? ph? thu?c v\`{a}o heap l\`{a}m cho c\'{a}c lo?i gi\'{a} tr? {\dj}?c bi?t h?u \'{i}ch trong {\dj}?c t?.

{\DJ}i?u {\dj}\'{o} kh\^{o}ng c\'{o} ngh\~{i}a l\`{a} b?n kh\^{o}ng th? c?p nh?t nh?ng th? v?i c\'{a}c lo?i gi\'{a} tr? trong n\'{o}. Bi?n c\'{a}i m\`{a} bao g?m lo?i gi\'{a} tr? c\'{o} th? {\dj}u?c c?p nh?t {\dj}? c\'{o} gi\'{a} tr? m?i c?a lo?i {\dj}\'{o}. T?t c? c\'{a}c lo?i gi\'{a} tr? c\'{o} th? {\dj}u?c luu tr? trong c\'{a}c tru?ng tr\^{e}n heap v\`{a} {\dj}u?c s? d?ng trong real code c\`{u}ng v?i c\'{a}c th\^{o}ng s? k\~{i} thu?t. c\'{a}c lo?i gi\'{a} tr? {\dj}u?c x\^{a}y d?ng tron Dafny l\`{a} sets, sequences, multisets, maps. 

\begin{enumerate}
\item  Sets
\end{enumerate}

Sets c?a c\'{a}c lo?i kh\'{a}c nhau t?o th\`{a}nh m?t trong nh?ng c\^{o}ng c? {\dj}? ki?m th? cho Dafny. Sets {\dj}?i di?n cho m?t b? suu t?p kh\^{o}ng c\'{o} th? t? c?a c\'{a}c ph?n t?, m\`{a} kh\^{o}ng l?p l?i.

Sets c\'{o} th? c\'{o} b?t k\`{i} lo?i n\`{a}o, bao g?m c? object.

\begin{enumerate}
\item  V\'{i} d? v? sets
\end{enumerate}

\noindent var s1 := $\{$$\}$; // set r?ng

\noindent var s2 := $\{$ 1, 2, 3$\}$;

\noindent var s3, s4 := $\{$1, 2$\}$ , $\{$1, 4$\}$;

\begin{enumerate}
\item  Hai set b?ng nhau n?u ch\'{u}ng c\'{o} c\'{a}c ph?n t? gi?ng nhau.

\item  Set m?i c\'{o} th? {\dj}u?c t?o ra b?ng c\'{a}ch s? d?ng c\'{a}c ph\'{e}p to\'{a}n:
\end{enumerate}

\noindent + Ph\'{e}p to\'{a}n h?i

\noindent assert s2 + s4 == $\{$1, 2, 3, 4$\}$

\noindent + Ph\'{e}p to\'{a}n h?p

\noindent assert s2 * s3 == $\{$1, 2$\}$

\noindent + Ph\'{e}p tr?

\noindent assert  s2 -- s3 == $\{$3$\}$.

\noindent C\'{a}c to\'{a}n t? so s\'{a}nh

\noindent + T?p h?p con

\noindent assert $\{$1, 2$\}$ $<$= $\{$1, 2, 3, 4$\}$

\noindent + Kh\^{o}ng c\'{o} m?i quan h?

\noindent assert !($\{$1, 2$\}$ $<$= $\{$1, 4, 5$\}$)

\noindent + B?ng nhau

\noindent assert $\{$1, 2$\}$ == $\{$1, 2$\}$

\noindent + Kh\^{o}ng b?ng nhau

\noindent assert $\{$ 1, 2, 3$\}$ != $\{$3, 4, 5$\}$

\begin{enumerate}
\item  Set c\`{o}n cung c?p c\'{a}c to\'{a}n t? in v\`{a} !in
\end{enumerate}

\noindent assert 5 in $\{$1, 2, 3, 4, 5$\}$

\noindent // kh?ng {\dj}?nh 5 n?m trong t?p $\{$1, 2, 3, 4, 5$\}$

\begin{enumerate}
\item  assert 1 !in $\{$2, 3, 4, 5$\}$
\end{enumerate}

\noindent // kh?ng {\dj}?nh 1 kh\^{o}ng n?m trong t?p $\{$2, 3, 4, 5$\}$

M?t c\'{a}ch h?u \'{i}ch {\dj}? t?o sets l\`{a} s? d?ng bao h\`{a}m m?t set. N\'{o} {\dj}?nh ngh\~{i}a m?t set m?i bao g?m {\dj}i?u ki?n f(x) sao cho v?i m?i x thu?c lo?i T b?t k\`{i} th?a m\~{a}n {\dj}i?u ki?n p(x).

\noindent Set x: T {\textbar} p(x) :: f(x)

\noindent V\'{i} d?: 

\noindent assert (set x {\textbar} x in $\{$0, 1, 2$\}$ :: x * 2) == $\{$0, 2, 4$\}$;

\begin{enumerate}
\item  Sequences\underbar{}
\end{enumerate}

Sequences (chu?i) l\`{a} m?t ki?u {\dj}u?c x\^{a}y d?ng trong Dafny, {\dj}?i di?n cho m?t danh s\'{a}ch c\'{o} th? t?. Ch\'{u}ng c\'{o} th? {\dj}u?c s? d?ng {\dj}? {\dj}?i di?n cho nhi?u lo?i t?p bao g?m danh s\'{a}ch, h\`{a}ng {\dj}?i, ng\u{a}n x?p, v.v. C\'{a}c Sequence l\`{a} m?t lo?i gi\'{a} tr? b?t bi?n: ch\'{u}ng kh\^{o}ng th? thay {\dj}?i khi {\dj}u?c t?o ra. Theo {\dj}\'{o}, ch\'{u}ng tuong t? c\'{a}c chu?i (string) trong c\'{a}c ng\^{o}n ng? Java v\`{a} Python, ngo\`{a}i ra ch\'{u}ng c\'{o} th? l\`{a} c\'{a}c chu?i c?a c\'{a}c ki?u t\`{u}y \'{y} ch? kh\^{o}ng ch? l\`{a} c\'{a}c chu?i c?a c\'{a}c k\'{y} t?. C\'{a}c lo?i Sequences {\dj}u?c vi?t: seq$<$int$>$ cho m?t chu?i s? nguy\^{e}n (Luu \'{y} m?t l?i {\dj}\~{a} ph\'{a}t hi?n trong Dafny ng\u{a}n c?n b?n t?o c\'{a}c chu?i c?a naturals, nat. ). V\'{i} d?, h\`{a}m n\`{a}y l?y m?t d\~{a}y nhu m?t tham s?:

predicate sorted(s: seq$<$int$>$)

$\{$

forall i, j :: 0 $<$= i $<$ j $<$ {\textbar}s{\textbar} ==$>$ s[i] $<$= s[j]

$\}$

Chi?u d\`{a}i c?a m?t chu?i {\dj}u?c vi?t {\textbar}s{\textbar}. C\'{a}c ph?n t? c? th? c?a m?t d\~{a}y {\dj}u?c truy c?p b?ng c\'{a}ch s? d?ng c\`{u}ng c\'{u} ph\'{a}p d?u ngo?c vu\^{o}ng nhu c\'{a}c m?ng. C\~{u}ng luu \'{y} r?ng h\`{a}m kh\^{o}ng {\dj}\`{o}i h?i m?t m?nh {\dj}? reads {\dj}? truy xu?t chu?i. {\DJ}\'{o} l\`{a} b?i v\`{i} chu?i kh\^{o}ng {\dj}u?c luu tr\^{e}n heap; ch\'{u}ng l\`{a} c\'{a}c gi\'{a} tr?, do {\dj}\'{o}, c\'{a}c ch?c n\u{a}ng kh\^{o}ng c?n khai b\'{a}o khi ch\'{u}ng truy c?p chu?i. Thu?c t\'{i}nh m?nh nh?t c?a chu?i l\`{a} c\'{a}c ch\'{u} th\'{i}ch v\`{a} c\'{a}c ch?c n\u{a}ng c\'{o} th? t?o ra v\`{a} thao t\'{a}c ch\'{u}ng. V\'{i} d?, m?t c\'{a}ch th? hi?n th? t? s?p x?p l\`{a} {\dj}? quy: n?u ph?n t? {\dj}?u ti\^{e}n nh? hon ph?n t? c\`{o}n l?i, v\`{a} ph?n c\`{o}n l?i {\dj}u?c s?p x?p th\`{i} to\`{a}n b? m?ng {\dj}u?c s?p x?p:

predicate sorted2(s: seq$<$int$>$)

$\{$

0  $<$ {\textbar}s{\textbar} ==$>$ (forall i :: 0 $<$ i $<$ {\textbar}s{\textbar} ==$>$ s[0] $<$= s[i]) \&\& sorted2(s[1..])

$\}$

K\'{y} hi?u s[1..] {\dj}ang c?t chu?i. N\'{o} c\'{o} ngh\~{i}a l\`{a} b?t {\dj}?u t? ph?n t? {\dj}?u ti\^{e}n, l?y c\'{a}c ph?n t? cho t?i khi k?t th\'{u}c. {\DJ}i?u n\`{a}y kh\^{o}ng thay {\dj}?i s v\`{i} c\'{a}c chu?i l\`{a} kh\^{o}ng thay {\dj}?i. Thay v\`{a}o {\dj}\'{o}, n\'{o} t?o m?t d\~{a}y m?i c\'{a}c t?t c? c\'{a}c ph?n t? gi?ng th?c t? tr\^{e}n, ngo?i t? ph?n t? {\dj}?u ti\^{e}n. {\DJ}i?u n\`{a}y tuong t? nhu vi?c th\^{e}m c\'{a}c s? nguy\^{e}n trong {\dj}\'{o} c\'{a}c gi\'{a} tr? ban {\dj}?u kh\^{o}ng thay {\dj}?i, m\`{a} ch? nh?ng gi\'{a} tr? m?i t?o ra. K\'{y} hi?u c?a s? ph\^{a}n chia l\`{a}: s[i..j] v?i 0 $<$= i $<$= j $<$= {\textbar}s{\textbar}. Dafny s? th?c thi c\'{a}c ch? s? n\`{a}y. Chu?i k?t qu? s? c\'{o} c\'{a}c ph?n t? j-i ch\'{i}nh x\'{a}c, v\`{a} s? b?t {\dj}?u v?i ph?n t? s[i] v\`{a} ti?p t?c tu?n t? qua chu?i, n?u k?t qu? kh\^{o}ng r?ng. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a} ph?n t? t?i ch? s? j b? lo?i tr? kh?i chu?i c?t, n\'{o} ph?n \'{a}nh th?i gian ngh\~{i} {\dj}? l?p ch? m?c th\^{o}ng thu?ng.

C\'{a}c chu?i c\~{u}ng c\'{o} th? {\dj}u?c x\^{a}y d?ng t? c\'{a}c th\`{a}nh ph?n c?a ch\'{u}ng, s? d?ng k\'{y} hi?u hi?n th?: var s := [1, 2, 3]; ? {\dj}\^{a}y ch\'{u}ng ta c\'{o} m?t bi?n nguy\^{e}n trong m?t s? {\dj}o?n code b?t bu?c c\'{o} ch?a c\'{a}c ph?n t? 1, 2 v\`{a} 3. Lo?i suy lu?n {\dj}\~{a} {\dj}u?c s? d?ng ? {\dj}\^{a}y l\`{a} chu?i l\`{a} m?t s? nguy\^{e}n. K\'{y} hi?u n\`{a}y cho ph\'{e}p ch\'{u}ng ta x\^{a}y d?ng chu?i r?ng v\`{a} c\'{a}c chu?i singleton:

[] //chu?i r?ng, c\'{o} th? l\`{a} m?t chu?i c?a b?t c? ki?u n\`{a}o

[true] // m?t chu?i singleton c?a ki?u seq$<$bool$>$

\noindent Ch\'{u} th\'{i}ch chu?i c?t v\`{a} k\'{y} hi?u hi?n th? c\'{o} th? {\dj}u?c s? d?ng {\dj}? ki?m tra thu?c t\'{i}nh c?a chu?i: 

\begin{enumerate}
\item  var s := [1, 2, 3, 4, 5];

\item  assert s[{\textbar}s{\textbar} - 1] == 5; //truy c?p ph?n t? cu?i c\`{u}ng

\item  assert s[{\textbar}s{\textbar} - 1..{\textbar}s{\textbar}] == [5]; //c?t chu?i {\dj}?n ph?n t? cu?i c\`{u}ng, nhu m?t singleton

\item  assert s[1..] == [2, 3, 4, 5]; //m?i s? tr? s? {\dj}?u ti\^{e}n 

\item  assert s[..{\textbar}s{\textbar} - 1] == [1, 2, 3, 4]; //m?i s? t? s? cu?i c\`{u}ng

\item  Assert s == s[0..] == s[..{\textbar}s{\textbar}] == s[0..{\textbar}s{\textbar}] == s[..]; // c? chu?i
\end{enumerate}

B?i {\dj}?n nay c\'{a}c l?nh ph? bi?t nh?t tr\^{e}n c\'{a}c chu?i {\dj}ang nh?n {\dj}u?c c\'{a}c ph?n t? {\dj}?u ti\^{e}n v\`{a} cu?i c\`{u}ng, v\`{a} nh?n {\dj}u?c t?t c? c\'{a}c ph?n t? kh\'{a}c tr? ph?n t? {\dj}?u ti\^{e}n v\`{a} cu?i c\`{u}ng, nhu thu?ng {\dj}u?c s? d?ng trong ch?c n\u{a}ng {\dj}? quy, ch?ng h?n nhu sorted2 ? tr\^{e}n. B\^{e}n c?nh ch?c n\u{a}ng {\dj}ang {\dj}u?c truy c?p ho?c c?t chu?i, sequence c\'{o} th? c\~{u}ng {\dj}? n?i, s? d?ng k\'{y} t? c?ng (+):

\begin{enumerate}
\item  assert [1,2,3] == [1] + [2,3];

\item  assert s == s + [];

\item  assert forall i :: 0 $<$= i $<$= {\textbar}s{\textbar} ==$>$ s == s[..i] + s[i..];
\end{enumerate}

L?nh assert th? 2 th? hi?n m?i quan h? gi?a n?i v\`{a} c?t chu?i. V\`{i} to\'{a}n t? c?t chu?i l\`{a} {\dj}?c quy?n tr\^{e}n m?t m?t v\`{a} bao g?m m?t kh\'{a}c, c\'{a}c ph?n t? xu?t hi?n trong n?i {\dj}\'{u}ng m?t l?n. Luu \'{y} r?ng to\'{a}n t? n?i l\`{a} k?t h?p: 

Assert forall a: seq$<$int$>$, b: seq$<$int$>$, c: seq$<$int$>$ :: 

(a+b) + c == a + (b + c)

\noindent Nhung {\dj}?nh l\'{y} Z3 s? kh\^{o}ng nh?n ra {\dj}i?u n\`{a}y tr? khi n\'{o} {\dj}u?c nh?c t?i v?i m?t assert th?c t?.

\begin{enumerate}
\item  Sequences c\~{u}ng h? tr? to\'{a}n t? in v\`{a} !in,  ki?m tra c\'{a}c r\`{a}ng bu?c trong m?t sequence:

\item  Assert 5 in s; //s? d?ng s t? tru?c

\item  Assert 0 !in s;
\end{enumerate}

\noindent {\DJ}i?u n\`{a}y c\~{u}ng cho ta m?t phuong ti?n thay th? {\dj}?nh lu?ng trong c\'{a}c ph?n t? c?a m?t sequence, khi ch\'{u}ng ta kh\^{o}ng quan t\^{a}m v? ch? s?. V\'{i} d?, ch\'{u}ng ta c\'{o} th? y\^{e}u c?u r?ng m?t sequence ch? ch?a c\'{a}c ph?n t? c\'{o} ch? s? trong sequence:

Var p := [2, 3, 1, 0];

Assert forall i :: i in p ==$>$ 0 $<$= i $<$ {\textbar}s{\textbar};

{\DJ}\^{a}y l\`{a} thu?c t\'{i}nh c?a m?i ph?n t? ri\^{e}ng c?a sequence. N?u ch\'{u}ng ta mu?n li\^{e}n k?t nhi?u y?u t? v?i nhau, ch\'{u}ng ra s? c?n ph?i {\dj}?nh lu?ng tr\^{e}n ch? s?, nhu trong v\'{i} d? {\dj}?u ti\^{e}n.

{\DJ}\^{o}i khi ch\'{u}ng ta mu?n c? th? c\^{a}p nh?t b?n ch?t c?a sequence. Trong khi ch\'{u}ng ta kh\^{o}ng th? thay {\dj}?i th? t? ban {\dj}?u, ch\'{u}ng ta c\'{o} th? t?o m?t sequence m?i v?i c\'{a}c y?u t?  tuong t? ? kh?p m?i noi ngo?i tr? c\'{a}c ph?n t? c?p nh?t:

s[i := v] //thay th? ch? s? i b?ng v trong seq s

T?t nhi\^{e}n, c\'{a}c ch? s? i ph?i l\`{a} ch? s? v\`{a}o m?ng. C\'{u} ph\'{a}p n\`{a}y l\`{a} m?t ph\'{i}m t?t cho m?t to\'{a}n t? c\'{o} th? th?c hi?n v?i c\'{a}c to\'{a}n t? thu?ng xuy\^{e}n c?t v\`{a} n?i. B?n c\'{o} th? {\dj}i?n v\`{a}o {\dj}o?n code du?i {\dj}\^{a}y {\dj}? th?c hi?n {\dj}i?u n\`{a}y?

Function update(s: seq$<$int$>$, I: int, v: int): seq$<$int$>$

Requires 0 $<$= index $<$ {\textbar}s{\textbar}

ensures update(s, I, v) == s[I := v]

\noindent $\{$

//m? trong editor {\dj}? xem {\dj}\'{a}p \'{a}n.

\noindent $\}$

B?n c\~{u}ng c\'{o} th? t?o th\`{a}nh m?t sequence t? c\'{a}c ph?n t? c?a m?ng. {\DJ}i?u n\`{a}y {\dj}u?c th?c hi?n b?ng c\'{a}ch s? d?ng c\'{a}c k\'{y} hi?u "slice" tuong t? nhu tr\^{e}n:

\begin{enumerate}
\item  var a := new int[3]; //3 ph?n t? m?ng c?a c\'{a}c s? nguy\^{e}n
\end{enumerate}

a[0], a[1], a[2] := 0, 3, -1;

\begin{enumerate}
\item  var s := a[..];

\item  assert s == [0, 3, -1];
\end{enumerate}

{\DJ}? c\'{o} {\dj}u?c m?t ph?n c?a m?ng,c\'{a}c bi\^{e}n c\'{o} th? {\dj}u?c {\dj}ua ra c\~{u}ng gi?ng nhu m?t to\'{a}n t? slicing th\^{o}ng thu?ng:

\begin{enumerate}
\item  assert a[1..] == [3, -1];

\item  assert a[..1] == [0];

\item  assert a[1..2] == [3];
\end{enumerate}

V\`{i} sequence h? tr? in v\`{a} !in, to\'{a}n t? n\`{a}y cho ch\'{u}ng ta m?t c\'{a}ch d? d\`{a}ng {\dj}? th? hi?n " ph?n t? kh\^{o}ng trong m?ng", chuy?n:

forall k :: 0 $<$= k $<$ a.length ==$>$ elem != a[k]

\noindent V\`{a}o:

elem !in a[..]

\noindent Hon n?a, bi\^{e}n {\dj}u?c bao g?m d? d\`{a}ng: forall k :: 0 $<$= k $<$ i ==$>$ elem != a[k]

\noindent Tuong t? nhu:

elem !in a[..i]

\begin{enumerate}
\item  Multisets
\end{enumerate}

Gi?ng nhu sets, ngo?i tr? ch\'{u}ng gi? d?u v?t c\'{o} bao nhi\^{e}u b?n copy c?a m?i ph?n t? ch\'{u}ng c\'{o}. {\DJ}i?u n\`{a}y l\`{a}m cho ch\'{u}ng {\dj}?c bi?t h?u \'{i}ch {\dj}? luu tr? t?p h?p c\'{a}c ph?n t? trong m?ng

Gi?ng nhu sets, multisets kh\^{o}ng c\'{o} th? t?. Nhi?u ho?t {\dj}?ng {\dj}u?c x\'{a}c {\dj}?nh trong sets c\~{u}ng c\'{o} s?n trong multisets. B?n c\'{o} th? s? d?ng in {\dj}? ki?m tra xem m?t v\`{a}i ph?n t? c\'{o} trong multisets hay kh\^{o}ng. Ph\'{e}p (+) l?y t?t c? c\'{a}c ph?n t? ? c? 2 multisets v\`{a} nh?ng ph?n t? tr\`{u}ng nhau ch? l?y m?t. Ph\'{e}p (-) ? multisets s? kh\'{a}c v?i sets khi gi\'{a} tr? c?a c\'{a}c ph?n t? trong multisets tr\`{u}ng nhau.

\noindent assert (multiset$\{$1,1,1$\}$ - multiset$\{$1,1$\}$) == multiset$\{$1$\}$;

\begin{enumerate}
\item  multiset disjoint (!!) ho?t {\dj}?ng nhu mong {\dj}?i. N\'{o} tr? v? true khi v\`{a} ch? khi hai multisets kh\^{o}ng c\'{o} th\`{a}nh ph?n chung. Hai multiset b?ng nhau n?u t?ng ph?n t? trong 2 multiset ph?i gi?ng nhau.

\item  Multisets c\'{o} th? {\dj}u?c t?o ra t? sequences v\`{a} sets b?ng c\'{a}ch s? d?ng multiset v?i ngo?c vu\^{o}ng.

\item  assert multiset([1,1]) == multiset$\{$1,1$\}$;

\item  assert multiset($\{$1,1$\}$) == multiset$\{$1$\}$;
\end{enumerate}

C? hai kh?ng {\dj}?nh {\dj}?u ch\'{i}nh x\'{a}c v\`{i} multiset c?a sequence xem x\'{e}t t?ng ph?n t?, trong khi sets ch? c\'{o} t?i {\dj}a m?t trong m?i ph?n t?. Dafny cho ph\'{e}p b?n vi?t $\{$1,1$\}$ n\'{o} gi?ng v?i $\{$1$\}$ b?i v\`{i} nh?ng s? tr\`{u}ng b? b? qua.

\begin{enumerate}
\item  Maps

\item  Maps trong Dafny {\dj}?i di?n cho m?ng li\^{e}n k?t. Kh\^{o}ng gi?ng nhu nh?ng lo?i tru?c, ch\'{u}ng c\'{o} hai lo?i: key v\`{a} value. C\'{a}c value c\'{o} th? {\dj}u?c l?y ra, t\`{i}m ki?m d?a tr\^{e}n key. M?t map c\'{o} c?u tr\'{u}c:
\end{enumerate}

\noindent map$<$U,V$>$  v?i U l\`{a} key, V l\`{a} value

\begin{enumerate}
\item  M?i map c\'{o} m?t domain, {\dj}\'{o} l\`{a} t?t c? c\'{a}c key m\`{a} map c\'{o} value. {\DJ}? ki?m tra xem m?t key c\'{o} n?m trong domain c\'{o} th? s? d?ng to\'{a}n t? in. Ngo\`{a}i ra 2 maps l\`{a} t\'{a}ch r?i (!!) n?u domain c?a ch\'{u}ng l\`{a} nh?ng t?p t\'{a}ch r?i.

\item  N?u m l\`{a} m?t map, th\`{i}  m[i:=j] l\`{a} m?t map m?i l\`{a} k?t qu? c?a vi?c th\^{e}m i v\`{a}o domain c?a m v\`{a} sau {\dj}\'{o} g\'{a}n key I v?i value j. N?u i {\dj}\~{a} {\dj}u?c g\'{a}n m?t gi\'{a} tr? th\`{i} n\'{o} s? ghi {\dj}\`{e} l\^{e}n trong map m?i. hai map l\`{a} b?ng nhau n?u ch\'{u}ng c\'{o} domain gi?ng nhau v\`{a} ch\'{u}ng \'{a}nh x? key b?ng nhau {\dj}?n value b?ng nhau. Luu \'{y} l\`{a} domain c?a m?t map ph?i h?u h?n.

\item  Gi?ng nhu sets, maps c\'{o} bao g?m m?t map. C\'{u} ph\'{a}p c\~{u}ng g?n gi?ng set
\end{enumerate}

\noindent map i: T {\textbar} p(i) :: f(i)

s? kh\'{a}c nhau gi?a maps v\`{a} sets l\`{a} i ? {\dj}\^{a}y l\`{a} key v\`{a} n\'{o} s? map v?i f(i).p(i). n\'{o} {\dj}u?c s? d?ng {\dj}? x\'{a}c {\dj}?nh mi?n c?a map m?i.

\begin{enumerate}
\item  v\'{i} d?: map i {\textbar} 0 $<$= I $<$ 10 :: 2*i

\item  \textbf{Dafny -- Lemmas (B? {\dj}?)}

\item \textbf{ }Introduction

\item  {\DJ}\^{o}i khi c\'{o} nh?ng bu?c logic y\^{e}u c?u ch?ng minh m?t chuong tr\`{i}nh l\`{a} {\dj}\'{u}ng, nhung ch\'{u}ng qu\'{a} ph?c t?p {\dj}?i v?i Dafny {\dj}? kh\'{a}m ph\'{a} v\`{a} s? d?ng. Khi {\dj}i?u n\`{a}y x\'{a}y ra, ch\'{u}ng ra c\'{o} th? h? tr? cho Dafny b?ng c\'{a}ch cung c?p m?t lemma.

\item  Lemmas l\`{a} m?t {\dj}?nh l\'{i} {\dj}u?c s? d?ng {\dj}? ch?ng minh m?t k?t qu? kh\'{a}c ch? kh\^{o}ng ph?i m?c ti\^{e}u c?a n\'{o}. Ch\'{u}ng cho ph\'{e}p Dafny t\'{a}ch b?ng ch?ng th\`{a}nh 2 ph?n: ch?ng minh lemma, sau {\dj}\'{o} s? d?ng n\'{o} {\dj}? ch?ng minh k?t qu? cu?i c\`{u}ng, k?t qu? cu?i c\`{u}ng l\`{a} s? ch\'{i}nh x\'{a}c c?a chuong tr\`{i}nh. Dafny v\`{a} m\'{a}y t\'{i}nh n\'{o}i chung, r?t ph\`{u} h?p cho s? ph\^{a}n chia nh?ng t\`{a}i li?u chi ti?t v\`{a} bao ph? t?t c? c\'{a}c ca ki?m th?. Nhung n\'{o} l?i thi?u th\^{o}ng minh {\dj}? xem c\'{a}c bu?c trung gian, c\'{a}i l\`{a}m cho vi?c ch?ng minh tr? n\^{e}n d? d\`{a}ng hon.

\item  B?ng vi?c vi?t v\`{a} s? d?ng Lemmas, b?n c\'{o} th? ch? ra nh?ng bu?c th?c hi?n l\`{a} g\`{i} v\`{a} khi n\`{a}o s? d?ng ch\'{u}ng trong chuong tr\`{i}nh. {\DJ}?c bi?t quan tr?ng l\`{a} {\dj}?i s? quy n?p, n\'{o} l\`{a} v?n {\dj}? kh\'{o} nh?t {\dj}?i v?i nh?ng ngu?i ch?ng minh {\dj}?nh l\'{i}.

\item  Searching for Zero

\item  V\'{i} d?: T\`{i}m ph?n t? 0 trong m?ng.
\end{enumerate}

{\DJ}i?u th\'{u} v? l\`{a} m?ng m\`{a} ta t\`{i}m ki?m c\'{o} hai thu?c t\'{i}nh {\dj}?c bi?t: t?t c? c\'{a}c ph?n t? trong m?ng kh\^{o}ng \^{a}m v\`{a} ph?n t? sau nh? hon ph?n t? tru?c m?t {\dj}on v?.

\noindent requires forall i :: 0 $<$= i $<$ a.Length ==$>$ 0 $<$= a[i]

\noindent requires forall i :: 0 $<$ i $<$ a.Length ==$>$ a[i-1]-1 $<$= a[i]

\noindent Gi?i thu?t t\`{i}m ph?n t? 0 trong m?ng

\noindent index := 0;

\noindent    while index $<$ a.Length

\noindent       invariant 0 $<$= index

\noindent       invariant forall k :: 0 $<$= k $<$ index \&amp;\&amp; k $<$ a.Length ==$>$ a[k] != 0

\noindent    $\{$

\noindent       if a[index] == 0 $\{$ return; $\}$

\noindent       index := index + a[index];

\noindent    $\}$

\noindent    index := -1;

M\~{a} n\`{a}y s? t\'{i}nh to\'{a}n {\dj}\'{u}ng k?t qu?, nhung Dafny ph\`{a}n n\`{a}n v? s? b?t bi?n c?a v\`{o}ng l?p th? hai. Dafny kh\^{o}ng tin r?ng b? qua nh?ng th\`{a}nh ph?n n\`{a}y l\`{a} h?p l\'{i}. L\'{i} do v\`{i} {\dj}i?u ki?n ti\^{e}n quy?t n\'{o}i r?ng m?i ph?n t? sau gi?m \'{i}t nh?t m?t, nhung n\'{o} kh\^{o}ng n\'{o}i g\`{i} v? m?i quan h? c?a c\'{a}c ph?n t? {\dj}?ng xa nhau. {\DJ}? thuy?t ph?c Dafny v? th?c t? n\`{a}y, ta c?n s? d?ng m?t lemma.

\begin{enumerate}
\item  Lemmas (B? {\dj}?)
\end{enumerate}

M?t lemma th?c s? ch? l\`{a} m?t phuong th?c ma. Thu?c t\'{i}nh mong mu?n n\^{e}u b?i lemma (ch\'{i}nh x\'{a}c hon, l\`{a} k?t lu?n c?a b? {\dj}?) {\dj}u?c tuy\^{e}n b? nhu l\`{a} {\dj}i?u ki?n, c\~{u}ng gi?ng nhu c\'{a}ch b?n l\`{a}m cho m?t phuong th?cth\^{o}ng thu?ng. Kh\^{o}ng gi?ng nhu m?t phuong th?c, m?t lemma kh\^{o}ng bao gi? {\dj}u?c ph\'{e}p thay {\dj}?i tr?ng th\'{a}i. V\`{i} m?t lemma l\`{a} ?o, n\'{o} kh\^{o}ng c?n ph?i {\dj}u?c g?i t?i th?i gian ch?y, do {\dj}\'{o}, tr\`{i}nh bi\^{e}n d?ch x\'{o}a n\'{o} tru?c khi xu?t m\~{a} th?c thi. V\`{i} v?y, lemma l\`{a} {\dj}?i di?n duy nh?t cho hi?u qu? c?a n\'{o} tr\^{e}n ki?m tra chuong tr\`{i}nh. B?n c\'{o} th? ngh\~{i} r?ng b? {\dj}? nhu kh?ng {\dj}?nh ch?c ch?n, trong {\dj}\'{o} h? {\dj}ang ch? c?n thi?t {\dj}? gi\'{u}p ch?ng minh c?a chuong tr\`{i}nh sau c\`{u}ng. Lemma {\dj}i?n h\`{i}nh c\'{o} th? nhu:

\noindent \includegraphics*[width=5.01in, height=1.04in, keepaspectratio=false]{image2}

{\DJ}?i v?i v?n {\dj}? t\`{i}m ki?m zero, c\'{a}c thu?c t\'{i}nh mong mu?n kh\^{o}ng c\'{o} trong s? c\'{a}c ph?n t? index cho {\dj}?n index + a[index] c\'{o} th? l\`{a} s? kh\^{o}ng. Ch\'{u}ng c\'{o} c\'{a}c m?ng v\`{a} ch? s? b?t {\dj}?u t? d?ng tham s?, v?i c\'{a}c y\^{e}u c?u th\^{o}ng thu?ng t? FindZero:

\noindent \includegraphics*[width=5.01in, height=1.91in, keepaspectratio=false]{image3}

Postcondition l\`{a} thu?c t\'{i}nh mong mu?n m\`{a} ch\'{u}ng ta mu?n. Gi?i h?n ph? i v\`{i} j + a[j] c\'{o} th? l\`{a} s? k?t th\'{u}c c?a m?ng. Ch\'{u}ng ta ch? mu?n n\'{o}i v? ch? s? trong ph?m vi {\dj}\'{o} m\`{a} c\~{u}ng l\`{a} ch? s? m?ng. Sau {\dj}\'{o} ch\'{u}ng ta th?c hi?n m?t bu?c r?t quan tr?ng: H\~{a}y ki?m tra lemma c?a ch\'{u}ng ta l\`{a} {\dj}? {\dj}? ch?ng minh c\'{a}c v\`{o}ng l?p b?t bi?n. B?ng c\'{a}ch ki?m tra n\`{a}y tru?c khi {\dj}i?n v\`{a}o lemma,ch\'{u}ng t\^{o}i {\dj}?m b?o r?ng ch\'{u}ng {\dj}ang c? g?ng {\dj}? ch?ng minh {\dj}\'{u}ng. C\'{a}c phuong th?c FindZero tr? th\`{a}nh:

\noindent \includegraphics*[width=5.02in, height=2.07in, keepaspectratio=false]{image4}

B\^{a}y gi? Dafny kh\^{o}ng ph\`{a}n n\`{a}n v? c\'{a}c phuong th?c FindZero, nhu lemma c?a postcondition cho th?y r?ng v\`{o}ng l?p b?t bi?n {\dj}u?c b?o t?n. N\'{o} ph?n \'{a}nh v? b? {\dj}? ch\'{i}nh n\'{o}, m\`{a} kh\^{o}ng ph?i l\`{a} {\dj}\'{a}ng ng?c nhi\^{e}n cho r?ng b\^{e}n trong r?ng. {\DJ}? c\'{o} {\dj}u?c Dafny ch?p nh?n b? {\dj}?, ch\'{u}ng ta s? ph?i ch?ng minh postcondition {\dj}\'{u}ng. Ch\'{u}ng ta l\`{a}m {\dj}i?u n\`{a}y nhu  l\`{a}m t?t c? m?i th? trong Dafny: vi?t m\~{a}.

Ch\'{u}ng ta t\^{o}i {\dj}?u v?i c\'{a}c thu?c t\'{i}nh quan tr?ng c?a m?ng, m\`{a} n\'{o} ch? l\`{a}m gi?m ch?m. Ch\'{u}ng tac\'{o} th? y\^{e}u c?u cho d\`{u} thu?c t\'{i}nh nh?t {\dj}?nh gi? b?ng c\'{a}ch s? d?ng assert. V\'{i} d?, ch\'{u}ng ta c\'{o} th? th?y r?ng Dafny bi?t:

\noindent \includegraphics*[width=5.02in, height=1.01in, keepaspectratio=false]{image5}

Do {\dj}\'{o} ch\'{u}ng ta c\'{o} th? th?y r?ng Dafny c\'{o} th? l\`{a}m theo trong bu?c b?t k?, v\`{a} th?m ch\'{i} c\'{o} th? chu?i ch\'{u}ng m?t c\'{a}ch th\'{i}ch h?p. Nhung s? lu?ng c\'{a}c bu?c ch\'{u}ng ta c?n ph?i th?c hi?n kh\^{o}ng ph?i l\`{a} h?ng s?: n\'{o} c\'{o} th? ph? thu?c v\`{a}o gi\'{a} tr? c?a a[j]. Nhung ch\'{u}ng t\^{o}i {\dj}\~{a} c\'{o} m?t c?u tr\'{u}c {\dj}? {\dj}?i ph\'{o} v?i m?t s? bi?n c?a bu?c: trong khi v\`{o}ng l?p!

Ch\'{u}ng t\^{o}i c\'{o} th? s? d?ng c?u tr\'{u}c r?t gi?ng nhau ? {\dj}\^{a}y {\dj}? c\'{o} {\dj}u?c Dafny chu?i c\'{a}c bu?c c\`{u}ng nhau. Ch\'{u}ng t\^{o}i mu?n l?p t? j {\dj}?n j + a[j], theo d\~{o}i c\'{a}c r\`{a}ng bu?c th?p hon khi ch\'{u}ng {\dj}i. Ch\'{u}ng t\^{o}i c\~{u}ng theo d\~{o}i th?c t? r?ng t?t c? c\'{a}c ph?n t? m\`{a} ch\'{u}ng t\^{o}i {\dj}\~{a} th?y cho {\dj}?n nay kh\^{o}ng ph?i 0:

\noindent \includegraphics*[width=5.01in, height=1.46in, keepaspectratio=false]{image6}

Bi?n {\dj}?u ti\^{e}n cho r\`{a}ng bu?c tr\^{e}n c\'{a}c y?u t? hi?n t?i, n?u ch\'{u}ng t\^{o}i {\dj}\~{a} kh\^{o}ng ch?y v\`{a}o cu?i m?ng. {\DJ}?i v?i m?i ch? s? trong qu\'{a} kh? j (trong {\dj}\'{o} c\'{o} nh?ng i-j), m?ng c\'{o} th? l\`{a} m?t s? nh? hon, do {\dj}\'{o}, gi\'{a} tr? n\`{a}y {\dj}u?c tr? {\dj}i t? a[j]. {\DJ}i?u n\`{a}y ch? n\'{o}i r?ng c\'{a}c ph?n t? hi?n t?i kh\^{o}ng th? b?ng 0, v?y m\`{a} kh\^{o}ng c\'{o} bi?n th? hai, Dafny s? kh\^{o}ng th? bi?t r?ng {\dj}\~{a} kh\^{o}ng c\'{o} s? 0. Dafny qu\^{e}n t?t c? m?i th? v? v? h\`{a}nh quy?t c?a v\`{o}ng ngo?i tr? nh?ng g\`{i} {\dj}u?c {\dj}ua ra trong invaraints, v\`{i} v?y ch\'{u}ng ta c?n ph?i x\^{a}y d?ng m?t th?c t? l\`{a} c\'{o} s? kh\^{o}ng c\'{o} b?t c? noi n\`{a}o cho {\dj}?n nay.

Th?t v?y! V\`{o}ng l?p ch? ra s? truy c?p. Nhu ch\'{u}ng ta {\dj}\~{a} th?y tru?c khi Dafny l\`{a} c\'{o} th? t\`{i}m ra m?i bu?c c?a ri\^{e}ng m\`{i}nh, v\`{i} v?y ch\'{u}ng t\^{o}i kh\^{o}ng c?n ph?i l\`{a}m b?t c? {\dj}i?u g\`{i} hon n?a. Ch\'{u}ng t\^{o}i ch? c?n thi?t {\dj}? cung c?p cho n\'{o} c?u tr\'{u}c c?a c\'{a}c b?ng ch?ng m\`{a} n\'{o} c?n thi?t {\dj}? th?c hi?n. {\DJ}\^{o}i khi c\'{a}c bu?c c\'{a} nh\^{a}n l\`{a} ph?c t?p, {\dj}? r?ng ch\'{u}ng c?n m?t ch\'{u}t ri\^{e}ng c?a ch\'{u}ng subproofs, s? d?ng ho?c l\`{a} m?t lo?t c\'{a}c c\^{a}u kh?ng {\dj}?nh ho?c m?t b? {\dj}? kh\'{a}c.

Khi l\`{a}m vi?c v?i m?ng, l?p {\dj}i l?p l?i l\`{a} m?t gi?i ph\'{a}p t? nhi\^{e}n cho nhi?u v?n {\dj}?. Kh\^{o}ng c\'{o} m?t s? l?n, Tuy nhi\^{e}n, khi {\dj}? quy {\dj}u?c s? d?ng {\dj}? x\'{a}c {\dj}?nh c\'{a}c ch?c n\u{a}ng ho?c thu?c t\'{i}nh. Trong nh?ng tru?ng h?p n\`{a}y, c\'{a}c b? {\dj}? thu?ng c\'{o} c\`{u}ng c?u tr\'{u}c {\dj}? quy. {\DJ}? xem m?t v\'{i} d? n\`{a}y, ch\'{u}ng t\^{o}i s? xem x\'{e}t c\'{a}c v?n {\dj}? c?a {\dj}?m.

\begin{enumerate}
\item  Counting ({\DJ}?m)
\end{enumerate}

Ch\'{u}ng ta s? {\dj}?m s? trues trong m?t chu?i bools, b?ng c\'{a}ch s? d?ng c\'{a}c ch?c n\u{a}ng count, {\dj}u?c {\dj}ua ra du?i {\dj}\^{a}y:

\noindent \includegraphics*[width=5.69in, height=2.29in, keepaspectratio=false]{image7}

M\~{a} n\`{a}y r?t {\dj}on gi?n, nhung m?t {\dj}i?u c?n ch\'{u} \'{y} l\`{a} ch?c n\u{a}ng l\`{a} {\dj}?nh ngh\~{i}a {\dj}? quy. Ch?c n\u{a}ng {\dj}? quy nhu th? n\`{a}y l\`{a} d? b? {\dj}\`{o}i h?i ph?i b? {\dj}?. {\DJ}\'{o} l\`{a} m?t thu?c t\'{i}nh mong mu?n c?a s? m\`{a} ch\'{u}ng t\^{o}i mu?n {\dj}? c\'{o} th? s? d?ng {\dj}? x\'{a}c minh m?t chuong tr\`{i}nh m\`{a} s? d?ng ch?c n\u{a}ng n\`{a}y: n\'{o} ph\^{a}n ph?i tr\^{e}n b? sung. B?ng c\'{a}ch n\`{a}y ch\'{u}ng c\'{o} ngh\~{i}a l\`{a}:

\noindent \includegraphics*[width=5.00in, height=0.32in, keepaspectratio=false]{image8}

? {\dj}\^{a}y, l?n {\dj}?u ti\^{e}n c?ng(+) l\`{a} tr\`{i}nh t? n?i, v\`{a} th? hai l\`{a} s? nguy\^{e}n b? sung. R\~{o} r\`{a}ng, ch\'{u}ng t\^{o}i c\'{o} th? ph\'{a} v? b?t k? th? t? th\`{a}nh hai chu?i a v\`{a} b, t\'{i}nh ch\'{u}ng ri\^{e}ng bi?t, v\`{a} th\^{e}m c\'{a}c k?t qu?. {\DJ}i?u n\`{a}y l\`{a} {\dj}\'{u}ng, nhung Dafny kh\^{o}ng th? ch?ng minh {\dj}i?u {\dj}\'{o} tr?c ti?p. V?n {\dj}? l\`{a} c\'{a}c ch?c n\u{a}ng kh\^{o}ng chia ra tr\`{i}nh t? theo c\'{a}ch n\`{a}y. C\'{a}c ch?c n\u{a}ng c?n c\'{a}c y?u t? {\dj}?u ti\^{e}n, t\'{i}nh s? c?a m\`{i}nh, sau {\dj}\'{o} th\^{e}m n\'{o} v\`{a}o ph?n c\`{o}n l?i c?a ti?n tr\`{i}nh. N?u a l\`{a} l\^{a}u d\`{a}i, sau {\dj}\'{o} n\'{o} c\'{o} th? l\`{a} m?t trong khi tru?c khi qu\'{a} tr\`{i}nh c\'{a}n n\`{a}y th?c s? {\dj}?t {\dj}?n count(b), do {\dj}\'{o}, Dafny kh\^{o}ng c? g?ng {\dj}? unwrap hon l\`{a} m?t v\`{a}i cu?c g?i {\dj}? quy. (Hai, {\dj}? {\dj}u?c ch\'{i}nh x\'{a}c. Xem gi?y m\'{a}y t\'{i}nh v?i m?t ngu?i gi?i quy?t SMT Amin, Leino v\`{a} Rompf, TAP 2014). {\DJ}\^{a}y l\`{a} m?t v\'{i} d? v? m?t t\`{a}i s?n m\`{a} y\^{e}u c?u m?t b? {\dj}? {\dj}? ch?ng minh.

Trong tru?ng h?p c?a ch\'{u}ng t\^{o}i, ch\'{u}ng t\^{o}i c\'{o} hai l?a ch?n cho b? {\dj}?: ch\'{u}ng t\^{o}i c\'{o} th? vi?t quantifier universal c\`{u}ng ch\'{u}ng t\^{o}i {\dj}\~{a} c\'{o} ? tr\^{e}n, ho?c ch\'{u}ng t\^{o}i c\'{o} th? l\`{a}m cho b? {\dj}? c? th? {\dj}? m?t c?p tr\`{i}nh t? a v\`{a} b. N\'{o} ch? ra r?ng khi ch\'{u}ng ta mu?n ph\^{a}n ph?i b?t {\dj}?ng s?n, ch\'{u}ng t\^{o}i kh\^{o}ng c?n t\`{a}i s?n {\dj}?y {\dj}? ph? qu\'{a}t. Ch\'{u}ng t\^{o}i l\`{a} ch? quan t\^{a}m {\dj}?n m?t th?c t? r?ng count(a + b) == count(a) + count(b) cho hai c? th? a v\`{a} b m\`{a} {\dj}u?c bi?t {\dj}?n trong chuong tr\`{i}nh. Do {\dj}\'{o} khi ch\'{u}ng t\^{o}i g?i l\`{a} b? {\dj}? {\dj}? c\'{o} {\dj}u?c t\`{a}i s?n, ch\'{u}ng t\^{o}i c\'{o} th? n\'{o}i {\dj}i?u {\dj}\'{o} hai chu?i m\`{a} ch\'{u}ng t\^{o}i quan t\^{a}m. N?u ch\'{u}ng t\^{o}i c\'{o} tr\`{i}nh t? kh\'{a}c nhau ? m?t noi kh\'{a}c, ch\'{u}ng t\^{o}i c\'{o} th? g?i c\'{a}c phuong ph\'{a}p v?i {\dj}?i s? kh\'{a}c nhau, gi?ng nhu m?t phuong ph\'{a}p th\^{o}ng thu?ng. N\'{o} ch? ra r?ng ch?ng minh t\`{a}i s?n {\dj}?y {\dj}? ph? qu\'{a}t, trong khi c\'{o} th?, l\`{a}m vi?c nhi?u hon so v?i ch?ng minh c\'{a}c tru?ng h?p c? th?, c? th?, do {\dj}\'{o}, ch\'{u}ng t\^{o}i s? gi?i quy?t tru?ng h?p n\`{a}y {\dj}?u ti\^{e}n.

Do {\dj}\'{o} b? {\dj}? n\^{e}n d\`{u}ng nhu l\`{a} {\dj}?i s? tr\`{i}nh t? quan t\^{a}m, v\`{a} postcondition l\`{a} nhu sau:

\noindent \includegraphics*[width=5.00in, height=0.84in, keepaspectratio=false]{image9}

\noindent 

\begin{enumerate}
\item  Proving the Distributive Property (Ch?ng minh ph\^{a}n ph?i thu?c t\'{i}nh)
\end{enumerate}

{\DJ}? vi?t b? {\dj}?, ch\'{u}ng ta ph?i t\`{i}m ra m?t chi?n lu?c {\dj}? ch?ng minh n\'{o}. Nhu b?n c\'{o} th? x\'{a}c minh ? tr\^{e}n (kh\^{o}ng c\'{o} \'{y} {\dj}?nh choi ch?), b? {\dj}? kh\^{o}ng ho?t {\dj}?ng {\dj}u?c n\^{e}u ra, nhu n?u kh\^{o}ng m?t b? {\dj}? s? l\`{a} kh\^{o}ng c?n thi?t. {\DJ}? l\`{a}m {\dj}i?u n\`{a}y, ch\'{u}ng t\^{o}i luu \'{y} r?ng l\'{y} do Dafny kh\^{o}ng ph?i c\'{o} th? ch?ng minh {\dj}i?u n\`{a}y ? noi {\dj}?u ti\^{e}n m\`{a} c\'{a}c count ch?c n\u{a}ng {\dj}u?c x\'{a}c {\dj}?nh t? khi b?t {\dj}?u c?a chu?i, trong khi c\'{a}c t\`{a}i s?n ph\^{a}n ph?i ho?t {\dj}?ng v\`{a}o gi?a c?a m?t chu?i. Do {\dj}\'{o} n?u ch\'{u}ng ta c\'{o} th? t\`{i}m th?y m?t c\'{a}ch {\dj}? l\`{a}m vi?c t? ph\'{i}a tru?c trong ti?n tr\`{i}nh, sau {\dj}\'{o} Dafny c\'{o} th? theo d\~{o}i b?ng c\'{a}ch s? d?ng {\dj}?nh ngh\~{i}a c?a c\'{a}c ch?c n\u{a}ng tr?c ti?p. V\^{a}ng, c\'{a}c y?u t? {\dj}?u ti\^{e}n c?a d\~{a}y l\`{a} g\`{i}? C\'{o} m?t v\`{a}i tru?ng h?p, d?a tr\^{e}n {\dj}\'{o} (n?u c\'{o}) c?a a v\`{a} b l\`{a} {\dj}?u c\'{o} s?n ph?m n\`{a}o. V\`{i} v?y b? {\dj}? ch\'{u}ng t\^{o}i s? ph?i xem x\'{e}t nhi?u tru?ng h?p, m?t {\dj}?c {\dj}i?m chung c?a b? {\dj}?. Ch\'{u}ng t\^{o}i nh?n th?y r?ng n?u a == [], sau {\dj}\'{o} a + b == b, b?t k? nh?ng g\`{i} b l\`{a}. B? {\dj}? x? l\'{y} tru?ng h?p s? d?ng c\`{u}ng m\~{a} {\dj}i?u n\`{a}o {\dj}? x? l\'{y} c\'{a}c tru?ng h?p: n?u b\'{a}o c\'{a}o. M?t ch?ng minh ng?n c?a c\'{a}c t\`{a}i s?n mong mu?n {\dj}u?c {\dj}ua ra s? d?ng kh?ng {\dj}?nh du?i {\dj}\^{a}y.

\noindent \includegraphics*[width=5.00in, height=2.07in, keepaspectratio=false]{image10}

Ch\'{u}ng t\^{o}i c\'{o} th? ki?m tra b? {\dj}? c?a ch\'{u}ng t\^{o}i trong tru?ng h?p n\`{a}y b?ng c\'{a}ch th\^{e}m m?t {\dj}\`{o}i h?i m?nh {\dj}? h?n ch? a tru?ng h?p n\`{a}y. Ch\'{u}ng t\^{o}i t\`{i}m th?y c\'{a}c m\~{a} x\'{a}c minh. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a} n?u a == [], sau {\dj}\'{o} b? {\dj}? c?a ch\'{u}ng t\^{o}i m?t c\'{a}ch ch\'{i}nh x\'{a}c s? ch?ng minh postcondition. Trong tru?ng h?p n\`{a}y, ch? kh?ng {\dj}?nh {\dj}?u ti\^{e}n ? tr\^{e}n l\`{a} c?n thi?t; Dafny {\dj}u?c ph?n c\`{o}n l?i c?a c\'{a}c bu?c tr\^{e}n ri\^{e}ng c?a m\`{i}nh (th? n\'{o}!). B\^{a}y gi? ch\'{u}ng ta c\'{o} th? xem x\'{e}t tru?ng h?p kh\'{a}c, khi 0 $<$ {\textbar}a{\textbar}. 

M?c ti\^{e}u c?a ch\'{u}ng t\^{o}i l\`{a} li\^{e}n quan {\dj}?n count(a + b) {\dj}? count(a) v\`{a} count(b). N?u a kh\^{o}ng ph?i l\`{a} tr\`{i}nh t? tr?ng r?ng, sau {\dj}\'{o} khi ch\'{u}ng t\^{o}i s? d?ng ch\'{u}ng t\^{o}i l?a c?a sau {\dj}?nh ngh\~{i}a m? r?ng count(a + b), ch\'{u}ng t\^{o}i nh?n {\dj}u?c:

\noindent \includegraphics*[width=5.00in, height=0.50in, keepaspectratio=false]{image11}

Th\^{o}ng b\'{a}o r?ng ch\'{u}ng t\^{o}i nh?n {\dj}u?c count([a[0]]) v\`{a} a[1..]. Nh?ng {\dj}i?u kho?n n\`{a}y hai c\~{u}ng s? xu?t hi?n n?u ch\'{u}ng ta m? r?ng count(a). C? th?:

\noindent \includegraphics*[width=5.00in, height=0.33in, keepaspectratio=false]{image12}

Cu?i c\`{u}ng, ch\'{u}ng t\^{o}i c\'{o} th? thay th? n\`{a}y {\dj}?nh ngh\~{i}a cho count(a) v\`{a}o postcondition {\dj}? c\'{o} {\dj}u?c:

\noindent \includegraphics*[width=5.00in, height=0.49in, keepaspectratio=false]{image13}

B\^{a}y gi? {\dj}i?u n\`{a}y tr\^{o}ng r?t gi?ng v?i nh?ng bi?u hi?n m\`{a} ch\'{u}ng t\^{o}i {\dj}\~{a} nh?n sau khi m? r?ng count(a + b). Kh\'{a}c bi?t duy nh?t l\`{a} count(a[1..] + b) {\dj}\~{a} tr? th\`{a}nh count(a[1..]) + count(b). Nhung {\dj}i?u n\`{a}y l\`{a} ch\'{i}nh x\'{a}c noi ch\'{u}ng t\^{o}i {\dj}ang c? g?ng {\dj}? ch?ng minh!

\begin{enumerate}
\item  Induction (C?m ?ng)
\end{enumerate}

C\'{a}c {\dj}?i s?, ch\'{u}ng t\^{o}i {\dj}ang c? g?ng {\dj}? l\`{a}m cho l\`{a} quy n?p. Ch\'{u}ng ta c\'{o} th? ch?ng minh m?c {\dj}\'{i}ch c?a ch\'{u}ng t\^{o}i cho r?ng m?t phi\^{e}n b?n nh? hon c?a v?n {\dj}? l\`{a} s? th?t. {\DJ}i?u n\`{a}y l\`{a} ch\'{i}nh x\'{a}c c\'{a}c kh\'{a}i ni?m c?a c?m ?ng: s? d?ng m?t phi\^{e}n b?n nh? hon c?a m?t v?n {\dj}? {\dj}? ch?ng minh m?t m?t l?n hon. {\DJ}? l\`{a}m {\dj}i?u n\`{a}y, ch\'{u}ng ta g?i l\`{a} s? h?u {\dj}? quy t? trong m\~{a} c?a ch\'{u}ng t\^{o}i. N\'{o} l\`{a} m?t phuong ph\'{a}p, do {\dj}\'{o}, n\'{o} c\'{o} th? {\dj}u?c k\'{i}ch ho?t b?t c? khi n\`{a}o ch\'{u}ng ta c?n n\'{o}.

Dafny s? gi? {\dj}?nh r?ng c\'{a}c cu?c g?i {\dj}? quy {\dj}\'{a}p ?ng {\dj}?c {\dj}i?m k? thu?t. {\DJ}\^{a}y l\`{a} gi? thi?t quy n?p, t?t c? c\'{a}c cu?c g?i {\dj}? quy c?a b? {\dj}? c\'{o} gi\'{a} tr?. {\DJ}i?u n\`{a}y ph? thu?c ch? y?u v\`{a}o m?t th?c t? r?ng Dafny c\~{u}ng ch?ng minh vi?c ch?m d?t. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a r?ng cu?i c\`{u}ng, b? {\dj}? s? kh\^{o}ng l\`{a}m cho m?t {\dj}? quy g?i. Trong tru?ng h?p n\`{a}y, {\dj}\^{a}y l\`{a} chi nh\'{a}nh {\dj}?u ti\^{e}n c?a n?u tuy\^{e}n b?. N?u kh\^{o}ng c\'{o} kh\^{o}ng c\'{o} cu?c g?i {\dj}? quy, sau {\dj}\'{o} b? {\dj}? ph?i {\dj}u?c ch?ng minh tr?c ti?p cho c\'{a}c tru?ng h?p {\dj}\'{o}. Sau {\dj}\'{o} m?i cu?c g?i trong ng\u{a}n x?p l\`{a} h?p l\'{y} trong gi? {\dj}?nh b? {\dj}? ho?t {\dj}?ng cho c\'{a}c tru?ng h?p nh? hon. N?u Dafny kh\^{o}ng ch?ng minh d\~{a}y ch?m d?t, sau {\dj}\'{o} chu?i c\'{o} th? ti?p t?c m\~{a}i m\~{a}i, v\`{a} gi? {\dj}?nh cho m?i cu?c g?i s? kh\^{o}ng {\dj}u?c ch?ng minh.

C?m ?ng n\'{o}i chung l\`{a} t\`{i}m m?t c\'{a}ch {\dj}? x\^{a}y d?ng c\'{a}c m?c ti\^{e}u c?a b?n l\^{e}n m?t bu?c t?i m?t th?i {\dj}i?m. Xem c\'{a}ch kh\'{a}c, n\'{o} ch?ng minh m?c ti\^{e}u c?a b?n trong {\dj}i?u kho?n c?a m?t phi\^{e}n b?n nh? hon. B? {\dj}? ph\^{a}n ph?i {\dj}u?c ch?ng minh b?i deconstructing n?i chu?i m?t ph?n t?i m?t th?i gian cho {\dj}?n khi c\'{a}c chu?i {\dj}?u ti\^{e}n l\`{a} ho\`{a}n to\`{a}n {\dj}i. Tru?ng h?p n\`{a}y {\dj}\~{a} {\dj}u?c ch?ng minh l\`{a} m?t tru?ng h?p co s?, v\`{a} sau {\dj}\'{o} to\`{a}n b? chu?i deconstructions {\dj}u?c x\'{a}c minh.

Ch\`{i}a kh\'{o}a {\dj}? l\`{a}m cho c\^{o}ng vi?c n\`{a}y l\`{a} Dafny kh\^{o}ng bao gi? c\'{o} {\dj}? xem x\'{e}t to\`{a}n b? chu?i c?a cu?c g?i. Ki?m tra ch?m d?t, n\'{o} c\'{o} th? nh?n {\dj}u?c c\'{a}c chu?i l\`{a} h?u h?n. Sau {\dj}\'{o}, t?t c? n\'{o} {\dj}\~{a} l\`{a}m l\`{a} ki?m tra m?t bu?c. N?u m?t bu?c t\`{u}y \'{y} l\`{a} h?p l?, sau {\dj}\'{o} to\`{a}n b? chu?i ph?i l\`{a} t?t. {\DJ}\^{a}y l\`{a} c\`{u}ng m?t logic Dafny s? d?ng cho v\`{o}ng: ki?m tra b?t bi?n vi?c gi? ban {\dj}?u, v\`{a} r?ng m?t trong nh?ng bu?c t\`{u}y \'{y} b?o t?n n\'{o}, v\`{a} b?n {\dj}\~{a} ki?m tra to\`{a}n b? v\`{o}ng, b?t k? bao nhi\^{e}u l?n trong v\`{o}ng l?p {\dj}i xung quanh. S? gi?ng nhau l\`{a} b? ngo\`{a}i nhi?u hon. C? hai lo?i b? {\dj}? (v\`{a} c? hai lo?i l\'{y} do Dafny l\`{a}m cho v? chuong tr\`{i}nh c?a b?n) l\`{a} quy n?p. C\~{u}ng kh\^{o}ng ph?i l\`{a} {\dj}\'{a}ng ng?c nhi\^{e}n cho c\'{a}c m?i quan h? gi?a l?p {\dj}i l?p l?i v\`{a} {\dj}? quy nhu l\`{a} hai phuong ti?n {\dj}? {\dj}?t {\dj}u?c {\dj}i?u tuong t?.

V?i {\dj}i?u n\`{a}y trong t\^{a}m tr\'{i}, ch\'{u}ng t\^{o}i c\'{o} th? ho\`{a}n th\`{a}nh b? {\dj}? b?ng c\'{a}ch g?i {\dj}? quy b? {\dj}? t?i c\'{a}c chi nh\'{a}nh kh\'{a}c c?a n?u tuy\^{e}n b?:

\noindent \includegraphics*[width=5.00in, height=1.71in, keepaspectratio=false]{image14}

B\^{a}y gi? b? {\dj}? x\'{a}c nh?n. Nhung nh?ng g\`{i} n?u ch\'{u}ng t\^{o}i mu?n nh?n m?i c?p tr\`{i}nh t? c\'{o} li\^{e}n quan theo c\'{a}ch n\`{a}y? Ch\'{u}ng t\^{o}i ph?i xem x\'{e}t s? d?ng m?t b? {\dj}? trong Dafny {\dj}? c\'{o} th? l\`{a}m {\dj}i?u n\`{a}y, ch\'{u}ng t\^{o}i s? kh\'{a}m ph\'{a} v?i m?t v\'{i} d? kh\'{a}c.

\begin{enumerate}
\item  Paths In a Directed Graph ({\dj}u?ng d?n trong m?t bi?u {\dj}? hu?ng d?n)\underbar{}
\end{enumerate}

Ph?n cu?i c\`{u}ng, n\^{a}ng cao hon, v\'{i} d? hon, ch\'{u}ng ta s? ch?ng minh thu?c t\'{i}nh v? c\'{a}c {\dj}u?ng d?n trong m?t {\dj}? th?. V? {\dj}i?u n\`{a}y, ch\'{u}ng ta s? c\'{o} d?p {\dj}? g?i m?t lemma (b? {\dj}?) ph? bi?n tr\^{e}n t?t c? c\'{a}c sequence (chu?i) c?a c\'{a}c n\'{u}t. M?t {\dj}? th? chu?n bao g?m m?t s? Nodes (n\'{u}t) v?i m?t s? li\^{e}n k?t t?i c\'{a}c Nodes kh\'{a}c. Nh?ng li\^{e}n k?t n\`{a}y c\'{o} hu?ng duy nh?t, v\`{a} nh?ng h?n ch? duy nh?t c?a ch\'{u}ng l\`{a} m?t Node kh\^{o}ng th? li\^{e}n k?t v?i ch\'{i}nh n\'{o}. C\'{a}c n\'{u}t {\dj}u?c {\dj}?nh ngh\~{i}a l\`{a}: 

Class Node

$\{$

//m?t tru?ng {\dj}?c l?p cho c\'{a}c n\'{u}t li\^{e}n k?t v?i nhau

var next: seq$<$Node$>$

$\}$

Ch\'{u}ng t\^{o}i {\dj}?i di?n cho m?t {\dj}? th? nhu l\`{a} m?t t?p h?p c?a c\'{a}c n\'{u}t null ch? tr? t?i c\'{a}c n\'{u}t kh\'{a}c trong {\dj}? th?, v\`{a} kh\^{o}ng {\dj}? b?n th\^{a}n. Ch\'{u}ng t\^{o}i g?i l\`{a} m?t t?p h?p c\'{a}c n\'{u}t {\dj}\'{o}ng c?a:

\noindent \includegraphics*[width=4.98in, height=1.71in, keepaspectratio=false]{image15}

Ch\'{u}ng {\dj}?i di?n cho m?t con {\dj}u?ng nhu l\`{a} m?t chu?i c\'{a}c n\'{u}t, noi m?i n\'{u}t {\dj}u?c li\^{e}n k?t b?i c\'{a}c n\'{u}t tru?c {\dj}\'{o} trong {\dj}u?ng d?n nonempty. Ch\'{u}ng x\'{a}c {\dj}?nh hai predicates, m?t trong {\dj}\'{o} x\'{a}c {\dj}?nh m?t {\dj}u?ng d?n h?p l? v\`{a} kh\'{a}c {\dj}? x\'{a}c {\dj}?nh li?u {\dj}u?ng d?n {\dj}u?c {\dj}ua ra l\`{a} m?t trong nh?ng h?p l? gi?a hai n\'{u}t c? th? trong bi?u {\dj}?:

\noindent \includegraphics*[width=5.02in, height=3.66in, keepaspectratio=false]{image16}

B\^{a}y gi? ch\'{u}ng t\^{o}i {\dj}ang s?n s\`{a}ng {\dj}? nh\`{a} nu?c b? {\dj}? ch\'{u}ng t\^{o}i mu?n ch?ng minh. Ch\'{u}ng ta xem x\'{e}t m?t {\dj}? th? v\`{a} m?t ti?u bi?u {\dj}?: m?t t?p h?p con c?a c\'{a}c n\'{u}t bi?u {\dj}? c\~{u}ng t?o th\`{a}nh m?t {\dj}? th?. {\DJ}? th? ph? n\`{a}y ph?i l\`{a} {\dj}\'{o}ng l?i, t?c l\`{a} kh\^{o}ng ch?a c\'{a}c li\^{e}n k?t b\^{e}n ngo\`{a}i c?a b?n th\^{a}n. N?u ch\'{u}ng ta c\'{o} t\`{i}nh h\`{i}nh nhu v?y, sau {\dj}\'{o} kh\^{o}ng th? c\'{o} m?t {\dj}u?ng d?n h?p l? t? m?t n\'{u}t trong bi?u {\dj}? ph? m?t n\'{u}t ? b\^{e}n ngo\`{a}i ti?u bi?u {\dj}? n\`{a}y. Ch\'{u}ng t\^{o}i s? g?i n\`{a}y th?c t? b? {\dj}? {\dj}\'{o}ng c?a, m\`{a} ch\'{u}ng t\^{o}i nh\`{a} nu?c trong Dafny nhu sau:

\noindent \includegraphics*[width=5.02in, height=1.70in, keepaspectratio=false]{image17}

Nh\`{a} nu?c l\`{a} {\dj}i?u ki?n ti\^{e}n quy?t t?t c? c\'{a}c y\^{e}u c?u: bi?u {\dj}? v\`{a} {\dj}? th? ph? l\`{a} h?p l?, n\'{u}t g?c l\`{a} trong bi?u {\dj}? ph?, nhung m?c ti\^{e}u kh\^{o}ng ph?i l\`{a}, v\`{a} t?t c? m?i th? {\dj}u?c ch?a trong c\'{a}c {\dj}? th? ch\'{i}nh. Postcondition n\'{o}i r?ng kh\^{o}ng l\`{a} kh\^{o}ng c\'{o} {\dj}u?ng d?n h?p l? t? g?c {\dj}?n m?c ti\^{e}u. ? {\dj}\^{a}y ch\'{u}ng t\^{o}i ch? ch?ng minh cho m?t c?p b?t {\dj}?u/k?t th\'{u}c n\'{u}t c? th?.

M?t c\'{a}ch {\dj}? ch?ng minh kh\^{o}ng t?n t?i c?a m?t c\'{a}i g\`{i} {\dj}\'{o} l\`{a} {\dj}? ch?ng minh cho b?t k? th? t? c\'{a}c n\'{u}t m\`{a} n\'{o} kh\^{o}ng th? l\`{a} m?t {\dj}u?ng d?n h?p l?. Ch\'{u}ng t\^{o}i c\'{o} th? l\`{a}m {\dj}i?u n\`{a}y v?i, b?n {\dj}o\'{a}n n\'{o}, m?t b? {\dj}?. B? {\dj}? n\`{a}y s? ch?ng minh cho b?t c? tr\`{i}nh t? nh?t {\dj}?nh, m\`{a} n\'{o} kh\^{o}ng th? l\`{a} m?t {\dj}u?ng d?n h?p l? t? root {\dj}? goal. Disproof m?t b? {\dj}? {\dj}u?ng d?n s? nhu:

\noindent \includegraphics*[width=4.98in, height=1.54in, keepaspectratio=false]{image18}

C\'{a}c {\dj}i?u ki?n ti\^{e}n quy?t l\`{a} tuong t? nhu ClosedLemma. {\DJ}? s? d?ng DisproofLemma ? ClosedLemma, ch\'{u}ng ta c?n ph?i g?i m?t l?n cho m?i chu?i c\'{a}c n\'{u}t. {\DJ}i?u n\`{a}y c\'{o} th? {\dj}u?c th?c hi?n v?i c?a Dafny forall tuy\^{e}n b?, m\`{a} t?p h?p c\'{a}c hi?u ?ng c?a co th? c?a n\'{o} cho t?t c? c\'{a}c gi\'{a} tr? cho bi?n {\dj}\'{o} b? r\`{a}ng bu?c.

\noindent \includegraphics*[width=5.02in, height=1.88in, keepaspectratio=false]{image19}

Nhu b?n th?y, {\dj}i?u n\`{a}y g\^{a}y ra c\'{a}c ClosedLemma {\dj}? x\'{a}c minh, v\`{i} v?y ch\'{u}ng t\^{o}i ki?m tra b? {\dj}? l\`{a} th\`{a}nh c\^{o}ng. Do {\dj}\'{o} DisproofLemma l\`{a} {\dj}? m?nh, v\`{a} c\^{o}ng vi?c c?a ch\'{u}ng t\^{o}i {\dj}u?c gi?m xu?ng ch? c?n ch?ng minh n\'{o}.

Kh\^{o}ng c\'{o} m?t v\`{a}i c\'{a}ch kh\'{a}c nhau m\`{a} m?t chu?i c\'{a}c n\'{u}t c\'{o} th? l\`{a} m?t {\dj}u?ng d?n kh\^{o}ng h?p l?. N?u {\dj}u?ng d?n l\`{a} tr?ng r?ng, sau {\dj}\'{o} n\'{o} kh\^{o}ng th? l\`{a} m?t {\dj}u?ng d?n h?p l?. Ngo\`{a}i ra, c\'{a}c y?u t? {\dj}?u ti\^{e}n c?a con {\dj}u?ng ph?i root v\`{a} c\'{a}c y?u t? cu?i c\`{u}ng c?n goal. B?i v\`{i} root in subgraph v\`{a} goal !in subgraph, ch\'{u}ng ta ph?i c\'{o} root != goal, v\`{i} v?y, ti?n tr\`{i}nh ph?i c\'{o} \'{i}t nh?t hai y?u t?. {\DJ}? ki?m tra Dafny nh\`{i}n th?y {\dj}i?u n\`{a}y, ch\'{u}ng t\^{o}i c\'{o} th? t?m th?i {\dj}?t {\dj}i?u ki?n ti\^{e}n quy?t b? {\dj}? c?a ch\'{u}ng t\^{o}i nhu sau:

\noindent \includegraphics*[width=4.98in, height=1.37in, keepaspectratio=false]{image20}

Luu \'{y} r?ng {\dj}i?u n\`{a}y s? g\^{a}y ra ClosedLemma {\dj}? ng\u{a}n ch?n x\'{a}c minh, nhu b? {\dj}? b\^{a}y gi? ch? ho?t {\dj}?ng cho m?t s? tr\`{i}nh t?. Ch\'{u}ng t\^{o}i s? b? qua ClosedLemma cho {\dj}?n khi ch\'{u}ng t\^{o}i {\dj}\~{a} ho\`{a}n th\`{a}nh DisproofLemma. {\DJ}i?u n\`{a}y {\dj}? ki?m ch?ng, c\'{o} ngh\~{i}a l\`{a} Dafny l\`{a} c\'{o} th? ch?ng minh postcondition trong nh?ng tru?ng h?p n\`{a}y. Do {\dj}\'{o}, ch\'{u}ng t\^{o}i ch? c?n ch?ng minh r?ng {\dj}u?ng d?n kh\^{o}ng h?p l? khi nh?ng {\dj}i?u ki?n n\`{a}y kh\^{o}ng gi?. Ch\'{u}ng t\^{o}i c\'{o} th? s? d?ng m?t if tuy\^{e}n b? {\dj}? th? hi?n {\dj}i?u n\`{a}y:

\noindent \includegraphics*[width=4.99in, height=0.69in, keepaspectratio=false]{image21}

N?u {\dj}u?ng l\`{a} \'{i}t nh?t hai y?u t? l\^{a}u d\`{a}i, c\'{a}c y?u t? {\dj}?u ti\^{e}n l\`{a} root, v\`{a} cu?i c\`{u}ng l\`{a} goal, sau {\dj}\'{o} ch\'{u}ng t\^{o}i c\'{o} m?t b?ng ch?ng hon n?a. N?u nh?ng {\dj}i?u ki?n n\`{a}y kh\^{o}ng {\dj}u?c {\dj}\'{a}p ?ng (c\'{o} ngh\~{i}a l\`{a}, n?u b?o v? c?a c\'{a}c if tuy\^{e}n b? l\`{a} sai, v\`{a} ki?m so\'{a}t ti?p t?c trong c\'{a}c chi nh\'{a}nh kh\'{a}c ti?m ?n) Dafny s? ch?ng minh postcondition ng\`{a}y c?a ri\^{e}ng m\`{i}nh (n\^{a}ng cao nh?n x\'{e}t: b?n c\'{o} th? ki?m tra n\`{a}y b?ng c\'{a}ch th\^{e}m c\'{a}c tuy\^{e}n b? t?m th?i assume false; b\^{e}n trong c\'{a}c chi nh\'{a}nh sau {\dj}\'{o} c?a c\'{a}c if). B\^{a}y gi? ch\'{u}ng ta ch? c?n {\dj}i?n th\^{e}m b?ng ch?ng m?t ph?n. L\`{a}m nhu v?y, ch\'{u}ng ta c\'{o} th? gi? {\dj}?nh c\'{a}c {\dj}i?u ki?n b?o v? c?a c\'{a}c if tuy\^{e}n b?. Ch\'{u}ng t\^{o}i b\^{a}y gi? c\'{o} th? s? d?ng quy n?p trick tuong t? nhu tr\^{e}n.

N?u ti?n tr\`{i}nh b?t {\dj}?u l\'{u}c root v\`{a} k?t th\'{u}c l\'{u}c goal, n\'{o} kh\^{o}ng th? h?p l? v\`{i} tr\`{i}nh t? ph?i t?i m?t s? {\dj}i?m c\'{o} m?t n\'{u}t m\`{a} kh\^{o}ng ph?i l\`{a} trong danh s\'{a}ch tru?c {\dj}\'{o} c\'{a}c n\'{u}t ti?p theo. Khi ch\'{u}ng t\^{o}i c\'{o} {\dj}u?c b?t k? th? t? c? th? nhu th? n\`{a}y, ch\'{u}ng t\^{o}i c\'{o} th? ph\'{a} v? n\'{o} th\`{a}nh hai tru?ng h?p: tr\`{i}nh t? kh\^{o}ng h?p l? trong c\'{a}c li\^{e}n k?t t? n\'{u}t {\dj}?u ti\^{e}n v\`{a}o th? hai, ho?c l\`{a} b? h?ng, m?t noi n\`{a}o {\dj}\'{o} xu?ng d\`{o}ng. Gi?ng nhu trong v\'{i} d? {\dj}?m, Dafny c\'{o} th? th?y r?ng n?u li\^{e}n k?t n\'{u}t {\dj}?u ti\^{e}n th? hai l\`{a} kh\^{o}ng h?p l?, sau {\dj}\'{o} tr\`{i}nh t? kh\^{o}ng th? l\`{a} m?t {\dj}u?ng d?n v\`{i} {\dj}i?u n\`{a}y guong {\dj}?nh ngh\~{i}a c?a path. V\`{i} v?y, ch\'{u}ng t\^{o}i ch? c\'{o} c\^{o}ng vi?c ph?i l\`{a}m g\`{i} n?u c\'{a}c li\^{e}n k?t {\dj}?u ti\^{e}n l\`{a} h?p l?. Ch\'{u}ng t\^{o}i c\'{o} th? b\`{a}y t? {\dj}i?u n\`{a}y v?i nhau if n?i dung:

\noindent \includegraphics*[width=5.00in, height=1.03in, keepaspectratio=false]{image22}

? {\dj}\^{a}y c\'{o} s? c?m ?ng. Ch\'{u}ng ta bi?t r?ng p[0] == root v\`{a} p[1] in p[0].next. Ch\'{u}ng t\^{o}i c\~{u}ng bi?t t? nh?ng {\dj}i?u ki?n ti\^{e}n quy?t m\`{a} root in subgraph. V\`{i} v?y, b?i v\`{i} closed(subgraph), ch\'{u}ng ta bi?t r?ng p[1] in subgraph. {\DJ}\^{a}y l\`{a} nh?ng {\dj}i?u ki?n c\`{u}ng ch\'{u}ng t\^{o}i b?t {\dj}?u v?i! Nh?ng g\`{i} ch\'{u}ng t\^{o}i c\'{o} ? {\dj}\^{a}y l\`{a} m?t phi\^{e}n b?n nh? hon c?a c\`{u}ng m?t v?n {\dj}?. Ch\'{u}ng t\^{o}i c\'{o} th? ch? c?n g?i {\dj}? quy DisproofLemma {\dj}? ch?ng minh r?ng p[1..] kh\^{o}ng ph?i l\`{a} m?t con {\dj}u?ng. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a}, m?t {\dj}?nh ngh\~{i}a c?a path, m\`{a} p kh\^{o}ng th? l\`{a} m?t con {\dj}u?ng, v\`{a} postcondition th? hai l\`{a} h\`{a}i l\`{o}ng. {\DJ}i?u n\`{a}y c\'{o} th? l\`{a} implmented nhu l\`{a}:

\noindent \includegraphics*[width=5.00in, height=2.24in, keepaspectratio=false]{image23}

B\^{a}y gi? DisproofLemma {\dj}? ki?m ch?ng, v\`{a} v?i vi?c lo?i b? c\'{a}c {\dj}i?u ki?n ti\^{e}n quy?t ki?m tra, ch\'{u}ng t\^{o}i th?y r?ng ClosedLemma x\'{a}c minh l\`{a} t?t. Do {\dj}\'{o} ch\'{u}ng t\^{o}i {\dj}\~{a} ch?ng minh r?ng kh\^{o}ng th? c\'{o} m?t {\dj}u?ng {\dj}i t? b\^{e}n trong m?t {\dj}? th? ti?u {\dj}\'{o}ng c?a v?i b\^{e}n ngo\`{a}i.

C\'{a}c forall tuy\^{e}n b? l\`{a} h?u \'{i}ch khi m?t b? {\dj}? c?n ph?i m?t s? ch?n l?n instantiated. V\'{i} d? cho th?y m?t phi\^{e}n b?n {\dj}on gi?n c?a c\'{a}c forall tuy\^{e}n b?. {\DJ}?i v?i phi\^{e}n b?n ti\^{e}n ti?n hon, xem, v\'{i} d?, Well-founded ch?c n\u{a}ng v\`{a} c?c Predicates trong Dafny: A hu?ng d?n b?i Leino, IWIL-2015, ho?c v\'{i} d? trong Dafny ki?m tra m?t.

Lu\^{o}n lu\^{o}n nh? {\dj}? ki?m tra b? {\dj}? c?a b?n l\`{a} {\dj}? {\dj}? ch?ng minh nh?ng g\`{i} b?n c?n. Kh\^{o}ng c\'{o} g\`{i} l\`{a} kh\'{o} ch?u hon so v?i chi ti\^{e}u m?t th?i gian l\`{a}m cho m?t b? {\dj}? ki?m tra, ch? {\dj}? t\`{i}m hi?u, b?n c?n m?t c\'{a}i g\`{i} {\dj}\'{o} m?nh m? hon. {\DJ}i?u n\`{a}y c\~{u}ng cho ph\'{e}p b?n tr\'{a}nh vi?c t?o ra m?t b? {\dj}? v?i m?t {\dj}i?u ki?n ti\^{e}n quy?t l\`{a} h?n ch? nhu v?y m\`{a} b?n kh\^{o}ng th? g?i n\'{o} l\`{a} noi m\`{a} b?n c?n.

\noindent 

\begin{enumerate}
\item  Modules

\item  Introduction

\item  Co c?u m?t chuong tr\`{i}nh b?ng c\'{a}ch ph\'{a} v? n\'{o} th\`{a}nh nhi?u ph?n l\`{a} m?t ph?n quan tr?ng c?a vi?c t?o ra c\'{a}c chuong tr\`{i}nh l?n. Trong Dafny, {\dj}i?u n\`{a}y {\dj}u?c th?c hi?n th\^{o}ng qua \textit{c\'{a}c module} .

\item  Cung c?p m?t c\'{a}ch {\dj}? nh\'{o}m l?i v?i nhau li\^{e}n quan {\dj}?n c\'{a}c lo?i, c\'{a}c class,method ,function v\`{a} c\'{a}c module kh\'{a}c nhau, c\~{u}ng nhu ki?m so\'{a}t ph?m vi c?a tuy\^{e}n b?. 

\item  Module c\'{o} th? nh?p kh?u l?n nhau {\dj}? t\'{a}i s? d?ng m\~{a}, v\`{a} n\'{o} c\'{o} th? tr?u tu?ng tr\^{e}n m\^{o}-{\dj}un {\dj}? t\'{a}ch ri\^{e}ng m?t th?c hi?n t? m?t giao di?n.

\item  Declaring New Modules\_ Module m?i

\item  M?t m\^{o}-{\dj}un m?i {\dj}u?c khai b\'{a}o v?i t? kh\'{o}a: 
\end{enumerate}

\noindent module Mod $\{$  ...$\}$

\begin{enumerate}
\item  Th\^{a}n m\^{o}-{\dj}un c\'{o} th? bao g?m b?t c? {\dj}i?u g\`{i} m\`{a} b?n c\'{o} th? {\dj}?t ? m?c c?p {\dj}?u, bao g?m classes, datatypes, types, methods, functions, etc.
\end{enumerate}

\noindent  module Mod $\{$  class C $\{$    var f: int;    method m()  $\}$  datatype Option = A(int) {\textbar} B(int)  type T  method m()  function f(): int$\}$

\begin{enumerate}
\item  Module l?ng nhau:
\end{enumerate}

\noindent module Mod $\{$  module Helpers $\{$class C $\{$      method doIt()      var f: int;       $\}$   $\}$$\}$

\begin{enumerate}
\item  Sau {\dj}\'{o}, b?n c\'{o} th? tham kh?o c\'{a}c c\'{a}c th\`{a}nh vi\^{e}n c?a module  Helpers trong module Mod  :
\end{enumerate}

\noindent module Mod $\{$  module Helpers $\{$ ... $\}$  method m() $\{$    var x := new Helpers.C;    x.doIt();    x.f := 4;   $\}$$\}$

\begin{enumerate}
\item  Medthod and function {\dj}u?c x\'{a}c {\dj}?nh ? c?p module c\'{o} s?n nhu c\'{a}c l?p, ch? v?i t\^{e}n m\^{o} {\dj}un {\dj}?t tru?c ch\'{u}ng. Ch\'{u}ng c\~{u}ng c\'{o} s?n trong c\'{a}c phuong ph\'{a}p v\`{a} ch?c n\u{a}ng c?a c\'{a}c l?p h?c trong c\`{u}ng m?t module:
\end{enumerate}

\noindent module Mod $\{$  module Helpers $\{$    function method addOne(n: nat): nat $\{$      n + 1    $\}$  $\}$  method m() $\{$    var x := 5;    x := Helpers.addOne(x); // x is now 6  $\}$$\}$.

\begin{enumerate}
\item \begin{enumerate}
\item  Theo m?c {\dj}?nh, {\dj}?nh ngh\~{i}a c\'{a}c h\`{a}m (v\`{a} c\'{a}c v? t?) {\dj}u?c hi?n th? b\^{e}n ngo\`{a}i m\^{o}-{\dj}un ch\'{u}ng {\dj}u?c {\dj}?nh ngh\~{i}a. Add assert x == 6;{\dj}?n cu?i m () s? x\'{a}c minh.
\end{enumerate}

\item  Importing and Exporting Modules

\item  Import

\item  T?o modules con m?i r?t h?u \'{i}ch, nhung {\dj}\^{o}i khi b?n mu?n tham kh?o nh?ng th? t? m?t m\^{o}-{\dj}un hi?n c\'{o}, ch?ng h?n nhu thu vi?n. Trong tru?ng h?p n\`{a}y, b?n c\'{o} th? nh?p m?t m\^{o} {\dj}un kh\'{a}c. {\DJ}i?u n\`{a}y {\dj}u?c th?c hi?n th\^{o}ng qua t? kh\'{o}a import, v\`{a} c\'{o} m?t v\`{a}i h\`{i}nh th?c kh\'{a}c nhau, m?i h\`{i}nh th?c c\'{o} m?t \'{y} ngh\~{i}a kh\'{a}c nhau.

\item  Lo?i {\dj}on gi?n nh?t l\`{a} nh?p kh?u c? th? v\`{a} c\'{o} d?ng import A = B. Tuy\^{e}n b? n\`{a}y t?o ra m?t tham chi?u {\dj}?n m\^{o} {\dj}un B (ph?i t?n t?i), v\`{a} li\^{e}n k?t n\'{o} v?i t\^{e}n m?i A:
\end{enumerate}

\noindent module Helpers $\{$  ...$\}$module Mod $\{$  import A = Helpers  method m() $\{$    assert A.addOne\eqref{GrindEQ__5_} == 6;  $\}$$\}$

\begin{enumerate}
\item  ? {\dj}\^{a}y s? d?ng A thay v\`{i} Helpers v?i method m(). {\DJ}? s? d?ng c\'{a}c th\`{a}nh ph?n c?a 1 module th\`{i} n\'{o} ph?i {\dj}u?c khai b\'{a}o trong {\dj}\'{o} ho?c {\dj}u?c import.

\item  Dafny kh\^{o}ng h? tr? 2 module tr\`{u}ng t\^{e}n c\`{u}ng 1 l\'{u}c, v\`{i} v?y {\dj}? {\dj}?m b?o ko xung {\dj}?t th\`{i} A\# Helpers.

\item  Export sets

\item  Import s? cho ph\'{e}p truy c?p v\`{a}o t?t c? c\'{a}c khai b\'{a}o (v\`{a} c\'{a}c {\dj}?nh ngh\~{i}a c?a ch\'{u}ng) t? m\^{o}-{\dj}un {\dj}u?c Import.{\DJ}? ki?m so\'{a}t {\dj}i?u n\`{a}y ch\'{i}nh x\'{a}c hon ch\'{u}ng ta c\'{o} th? s? d?ng c\'{a}c b? Export.

\item  M?i b? Export c\'{o} th? c\'{o} m?t danh s\'{a}ch c\'{a}c t? khai t? m\^{o}-{\dj}un hi?n t?i, {\dj}u?c {\dj}ua ra nhu provides( cung c?p) ho?c reveals( ti?t l?). Export kh\^{o}ng c\'{o} t\^{e}n {\dj}u?c coi l\`{a} Export m?c {\dj}?nh cho m\^{o} {\dj}un {\dj}\'{o} v\`{a} {\dj}u?c s? d?ng khi kh\^{o}ng c\'{o} t?p h?p {\dj}u?c {\dj}?t t\^{e}n r\~{o} r\`{a}ng.
\end{enumerate}

\noindent module Helpers $\{$  export Spec provides addOne, addOne\_result  export Body reveals addOne  export extends Spec  function method addOne(n: nat): nat  $\{$    n + 1  $\}$  lemma addOne\_result(n : nat)     ensures addOne(n) == n + 1  $\{$ $\}$$\}$

\begin{enumerate}
\item  Theo v\'{i} d? tr\^{e}n th\`{i} c\'{o} 3 b? export:

\item  Spec: {\dj}u?c {\dj}ua ra du?i d?ng provides: ch? cho ph\'{e}p truy c?p v\`{a}o function addOne, nhung ko cho truy c?p v\`{a}o {\dj}?nh ngh\~{i}a c?a n\'{o}

\item  Body: {\dj}ua ra du?i dang reveals cho ph\'{e}p truy c?p v\`{a}o th\^{a}n function addOne

\item  Spec: Export m?c {\dj}?nh, l\`{a} m? r?ng c?a b? Spec, n\'{o} ch? {\dj}on gi?n cung c?p cho t?t c? c\'{a}c tuy\^{e}n b? Export m\`{a} Spec l\`{a}m.
\end{enumerate}

\noindent module Mod1 $\{$  import A = Helpers`Body  method m() $\{$    assert A.addOne\eqref{GrindEQ__5_} == 6; // succeeds, we have access to addOne's body  $\}$  method m2() $\{$    //A.addOne\_result\eqref{GrindEQ__5_}; // error, addOne\_result is not exported from Body    assert A.addOne\eqref{GrindEQ__5_} == 6;  $\}$$\}$module Mod2 $\{$  import A = Helpers`Spec  method m() $\{$    assert A.addOne\eqref{GrindEQ__5_} == 6; // fails, we don't have addOne's body  $\}$  method m2() $\{$    A.addOne\_result\eqref{GrindEQ__5_};    assert A.addOne\eqref{GrindEQ__5_} == 6; // succeeds due to result from addOne\_result  $\}$$\}$module Mod3 $\{$  import A = Helpers  method m() $\{$    assert A.addOne\eqref{GrindEQ__5_} == 6; // fails, we don't have addOne's body  $\}$$\}$

\begin{enumerate}
\item  c\'{o} th? s? d?ng b? Export {\dj}? ki?m so\'{a}t nh?ng {\dj}?nh ngh\~{i}a ki?u n\`{a}o c\'{o} s?n.T?t c? c\'{a}c khai b\'{a}o ki?u (v\'{i} d? lo?i m?i, lo?i, lo?i d? li?u, v.v.) c\'{o} th? {\dj}u?c xu?t kh?u nhu provides or reveals.
\end{enumerate}

\noindent module Helpers $\{$  export provides f, T  export Body reveals f, T  type T = int  function f(): T $\{$ 0 $\}$$\}$module Mod $\{$  import A = Helpers  function g(): A.T $\{$ 0 $\}$ // error, T is not known to be int, or even numeric  function h(): A.T $\{$ A.f() $\}$ // okay$\}$

\begin{enumerate}
\item  M?t khi xu?t kh?u {\dj}\~{a} {\dj}u?c nh?p kh?u cho th?y m?t  opaque type( lo?i m?, ko r\~{o}) tru?c {\dj}\^{a}y, t?t c? c\'{a}c s? d?ng hi?n t?i c?a n\'{o} {\dj}u?c bi?t l\`{a} inner type.
\end{enumerate}

\noindent module Mod2 $\{$  import M = Mod  import A = Helpers`Body  function j(): int    ensures j() == 0 //succeeds  $\{$ M.h() $\}$$\}$

\noindent 

\begin{enumerate}
\item  k\'{y} hi?u {\dj}?c bi?t "*" c\'{o} th? {\dj}u?c {\dj}ua ra sau khi provides or reveals {\dj}? ch? ra r?ng t?t c? c\'{a}c khai b\'{a}o ph?i {\dj}u?c cung c?p ho?c ti?t l?.
\end{enumerate}

\noindent module A $\{$   export All reveals * // reveals T, f, g   export Spec provides * // provides T, f, g   export Some provides * reveals g // provides T, f reveals g   type T = int   function f(): T $\{$ 0 $\}$   function g(): int $\{$ 2 $\}$$\}$

\begin{enumerate}
\item  c\'{o} th? cung c?p nhi?u Export c\`{u}ng m?t l\'{u}c {\dj}? t?o ra m?t t?p h?p Import.
\end{enumerate}

\noindent module A $\{$  export Justf reveals f  export JustT reveals T  type T = int  function f(): int $\{$ 0 $\}$$\}$module B $\{$  import A`$\{$Justf,JustT$\}$  function g(): A.T $\{$ A.f() $\}$$\}$

\begin{enumerate}
\item  Export Consistency\_ T\'{i}nh nh?t qu\'{a}n trong Export

\item  tr\`{i}nh b\`{a}y m?t c\'{a}i nh\`{i}n nh?t qu\'{a}n c?a m?t module:  b?t c? th? g\`{i} xu?t hi?n trong m?t tuy\^{e}n b? Export ch\'{i}nh n\'{o} ph?i {\dj}u?c exported.Xem l?i v\'{i} d? tru?c, ch\'{u}ng ta kh\^{o}ng th? t?o m?t t?p xu?t xu?t hi?n cho th?y f m\`{a} kh\^{o}ng ti?t l? T. {\DJ}\^{a}y l\`{a} l\'{y} do {\dj}on gi?n m\`{a} ch\'{u}ng ta s? t?o ra m?t r\`{a}ng bu?c ki?u 0: T m\`{a} kh\^{o}ng th? gi?i quy?t n?u T l\`{a} m? {\dj}?c. Tuong t? nhu v?y, ch\'{u}ng ta kh\^{o}ng th? t?o m?t t?p xu?t m\`{a} cung c?p ho?c ti?t l? f n?u ch\'{u}ng ta kh\^{o}ng \'{i}t nh?t c\~{u}ng cung c?p T.
\end{enumerate}

\noindent module Helpers $\{$  export provides f, T // good  export Body reveals f, T // good  export BadSpec reveals f, provides T // bad  export BadSpec2 provides f // bad  type T = int  function f(): T $\{$ 0 $\}$$\}$

\begin{enumerate}
\item  V\`{i} ch\'{u}ng ta c\'{o} th? x\'{a}c {\dj}?nh c\'{a}c module c\'{o} ch?a c? t? khai import, export, ch\'{u}ng ta c?n ph?i xu?t c\'{a}c t? khai t? c\'{a}c module ngo\`{a}i {\dj}? t?o m?t b? xu?t kh?u nh?t qu\'{a}n. Tuy\^{e}n b? t? c\'{a}c module ngo\`{a}i kh\^{o}ng th? {\dj}u?c {\dj}ua v\`{a}o Export m?t c\'{a}ch tr?c ti?p, tuy nhi\^{e}n vi?c import cung c?p ch\'{u}ng c\'{o} th?.
\end{enumerate}

\noindent 

\noindent module Mod $\{$  export Try1 reveals h // error  export Try2 reveals h, provides A.f, A.T // error, can't provide these directly  export reveals h, provides A // good  import A = Helpers  function h(): A.T $\{$ A.f() $\}$$\}$

\begin{enumerate}
\item  Khi Import Mod ch\'{u}ng ta b\^{a}y gi? c\~{u}ng c\'{o} {\dj}u?c quy?n truy c?p {\dj}? {\dj}i?u ki?n v\`{a}o nh?ng g\`{i} {\dj}u?c cung c?p trong ImportA. Ch\'{u}ng t\^{o}i c\~{u}ng c\'{o} th? ch?n {\dj}? tr?c ti?p nh?p kh?u n\`{a}y, {\dj}? cung c?p cho h? m?t c\'{a}i t\^{e}n ng?n hon.module Mod2 $\{$  import M = Mod  import MA = M.A  function j(): M.A.T $\{$ M.h() $\}$  function k(): MA.T $\{$ j() $\}$$\}$

\item  Opening Modules
\end{enumerate}

{\DJ}\^{o}i khi ti?n t? c\'{a}c th\`{a}nh ph?n c?a module m\`{a} b?n nh?p v?i t\^{e}n th?t t? nh?t v\`{a} x?u, ngay c? khi b?n ch?n m?t c\'{a}i t\^{e}n ng?n khi nh?p n\'{o}. Trong tru?ng h?p n\`{a}y, b?n c\'{o} th? Import Module nh?p"opened", khi?n t?t c? c\'{a}c th\`{a}nh vi\^{e}n c?a n\'{o} kh? d?ng m\`{a} kh\^{o}ng c?n th\^{e}m t\^{e}n module

module Mod $\{$  import opened Helpers  method m() $\{$    assert addOne\eqref{GrindEQ__5_} == 6;  $\}$$\}$

Khi open 1 module th\`{i} c\'{a}c th\`{a}nh ph?n m?i s? c\'{o} m?c {\dj}? uu ti\^{e}n th?p hon n\^{e}n ch\'{u}ng s? b? ?n b?i local definitions ({\dj}?nh ngh\~{i}a c?c b?). {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a} n?u b?n {\dj}?nh ngh\~{i}a 1 h\`{a}m {\dj}?a phuong g?i addOne(), th\`{i} h\`{a}m t? Helpers s? kh\^{o}ng c\'{o} s?n du?i t\^{e}n {\dj}\'{o} n?a.

\noindent Khi c\'{a}c module {\dj}u?c m? th\`{i} r\`{a}ng bu?c ban {\dj}?u v?i t\^{e}n {\dj}\'{o} v?n c\`{o}n v\`{i} v?y b?n c\'{o} th? s? d?ng t\^{e}n {\dj}\~{a} b? r\`{a}ng bu?c {\dj}? nh?n c\'{a}c th? b? ?n {\dj}i.

\noindent module Mod $\{$  import opened Helpers  function addOne(n: nat): nat $\{$    n + 2  $\}$  method m() $\{$    assert addOne\eqref{GrindEQ__5_} == 6; // this is now false,                           // as this is the function just defined    assert Helpers.addOne\eqref{GrindEQ__5_} == 6; // this is still true  $\}$$\}$

\begin{enumerate}
\item  N?u 2 module c\`{u}ng {\dj}u?c m? v\`{a} c\'{a}c th\`{a}nh ph?n c\'{o} c\`{u}ng t\^{e}n th\`{i} ph?i c\'{o} ti?n t? modul th\`{i} m?i c\'{o} th? g?i {\dj}u?c. T? kh\'{o}a opend c\'{o} th? {\dj}u?c s? d?ng  v?i b?t k\`{i} lo?i khai b\'{a}o import n\`{a}o k? c? module tr?u tu?ng.

\item  Module Abstraction\underbar{}
\end{enumerate}

S? d?ng 1 Import abstract module khi s? d?ng c\'{a}ch th?c hi?n c? th? kh\^{o}ng hi?u qu?, c?n 1 module th?c hi?n 1 s? interface.

Trong Dafny vi?t import A:B c\'{o} ngh\~{i}a l\`{a} r\`{a}ng bu?c t\^{e}n A nhung thay v\`{i} nh?n {\dj}u?c ch\'{i}nh x\'{a}c module B th\`{i} nh?n {\dj}u?c b?t k\`{i} module l\`{a} s\`{a}ng l?c c?a B. Th\^{o}ng thu?ng module B c\'{o} th? c\'{o} c\'{a}c {\dj}?nh ngh\~{i}a tr?u tu?ng, c\'{a}c class v?iphuong th?c bodyless, ho?c kh\^{o}ng th\'{i}ch h?p {\dj}? s? d?ng tr?c ti?p. B?t k\`{i} s\`{a}ng l?c n\`{a}o c?a B c\'{o} th? {\dj}u?c s? d?ng an to\`{a}n.

\noindent M? {\dj}?u v?i: 

\noindent module Interface $\{$  function method addSome(n: nat): nat    ensures addSome(n) $>$ n$\}$module Mod $\{$  import A : Interface  method m() $\{$    assert 6 $<$= A.addSome\eqref{GrindEQ__5_};  $\}$$\}$

Nh?n th?y: c\'{o} th? bi?t ch\'{i}nh x\'{a}c hon n?u bi?t r?ng addSome th?c s? t\u{a}ng ch\'{i}nh x\'{a}c 1.  C\'{a}c module du?i {\dj}\^{a}y c\'{o} h\`{a}nh vi n\`{a}y. Hon n?a h?u {\dj}i?u ki?n {\dj}u?c l\`{a}m m?nh hon n\^{e}n ch?c ch?n {\dj}\^{a}y l\`{a} 1 s\`{a}ng l?c c?a interface module.

\noindent module Implementation refines Interface $\{$  function method addSome(n: nat): nat    ensures addSome(n) == n + 1  $\{$    n + 1  $\}$$\}$

\begin{enumerate}
\item  Sau {\dj}\'{o} c\'{o} th? thay th? Implementation cho A trong 1 module m?i,
\end{enumerate}

\noindent module Mod2 refines Mod $\{$  import A = Implementation  ...$\}$ 

Khi tinh ch?nh abstract import th\`{a}nh 1 kh?i c? th?, module c? th? ph?i l\`{a} 1 s\`{a}ng l?c r\~{o} r\`{a}ng v? 1 tr?u tu?ng.( {\dj}\~{a} {\dj}u?c khai b\'{a}o v?i refines) 

\noindent 

\begin{enumerate}
\item  Module Ordering and Dependencies\underbar{ (T? ch?c v\`{a} s? ph? thu?c)}
\end{enumerate}

Dafny kh\^{o}ng ph?i qu\'{a} ch\'{u} tr?ng v? th? t? c\'{a}c m\^{o}-{\dj}un xu?t hi?n, nhung h? ph?i tu\^{a}n theo m?t s? quy t?c {\dj}? {\dj}u?c h\`{i}nh th\`{a}nh t?t. Theo nguy\^{e}n t?c chung, c?n ph?i c\'{o} c\'{a}ch {\dj}? {\dj}?t c\'{a}c m\^{o}-{\dj}un trong m?t chuong tr\`{i}nh sao cho m?i c\'{a}i ch? {\dj}? c?p {\dj}?n nh?ng {\dj}i?u {\dj}u?c {\dj}?nh ngh\~{i}a tru?c khi n\'{o} xu?t hi?n trong v\u{a}n b?n ngu?n. {\DJ}i?u {\dj}\'{o} kh\^{o}ng c\'{o} ngh\~{i}a l\`{a} c\'{a}c m\^{o}-{\dj}un ph?i {\dj}u?c {\dj}ua ra theo th? t? {\dj}\'{o}. Dafny s? t\`{i}m ra l?nh {\dj}\'{o} cho b?n, gi? s? b?n kh\^{o}ng th?c hi?n b?t k? t\`{a}i li?u tham kh?o th\^{o}ng tu n\`{a}o. V\'{i} d?, {\dj}i?u n\`{a}y l\`{a} kh\'{a} r\~{o} r\`{a}ng v\^{o} ngh\~{i}a:

\noindent import A = Bimport B = A

\noindent 

\noindent B?n c\'{o} th? import tuy\^{e}n b? ? c?p cu?i, v\`{a} b?n c\'{o} th? nh?p c\'{a}c m\^{o}-{\dj}un x\'{a}c {\dj}?nh c\`{u}ng c?p:

\noindent import A = Bmethod m() $\{$  A.whatever();$\}$module B $\{$ method whatever() $\{$$\}$ $\}$

\noindent 

Trong tru?ng h?p n\`{a}y, m?i th? {\dj}?u {\dj}u?c {\dj}?nh ngh\~{i}a b?i v\`{i} ch\'{u}ng ta c\'{o} th? {\dj}?t B {\dj}?u ti\^{e}n, ti?p theo l\`{a} import A, v\`{a} cu?i c\`{u}ng l\`{a} m (). N?u kh\^{o}ng c\'{o} l?nh, th\`{i} Dafny s? {\dj}ua ra m?t l?i, ph\`{a}n n\`{a}n v? s? ph? thu?c theo chu k?.

Luu \'{y} r?ng khi s?p x?p l?i m\^{o}-{\dj}un v\`{a} import, ch\'{u}ng ph?i {\dj}u?c gi? trong c\`{u}ng m?t m\^{o}-{\dj}un c\'{o} ch?a, cho ph\'{e}p lo?i b? m?t s? c?u tr\'{u}c m\^{o} b?nh l\'{y}. Ngo\`{a}i ra, h\`{a}ng nh?p kh?u v\`{a} m\^{o}-{\dj}un lu\^{o}n lu\^{o}n {\dj}u?c coi l\`{a} l?n {\dj}?u ti\^{e}n, ngay c? ? c?p cao. {\DJ}i?u n\`{a}y c\'{o} ngh\~{i}a l\`{a} nh?ng {\dj}i?u sau {\dj}\^{a}y kh\^{o}ng {\dj}u?c h\`{i}nh th\`{a}nh:

\noindent method doIt() $\{$ $\}$module M $\{$  method m() $\{$    doIt();  $\}$$\}$

B?i v\`{i} m\^{o} {\dj}un M ph?i {\dj}u?c khai b\'{a}o {\dj}?u ti\^{e}n tru?c b?t k? khai b\'{a}o n\`{a}o, ch?ng h?n nhu c\'{a}c phuong ph\'{a}p. {\DJ}? x\'{a}c {\dj}?nh c\'{a}c h\`{a}m to\`{a}n c?u nhu th? n\`{a}y, b?n c\'{o} th? {\dj}?t ch\'{u}ng trong m?t m\^{o} {\dj}un (g?i l\`{a} Globals) v\`{a} m? n\'{o} v\`{a}o b?t k? m\^{o} {\dj}un n\`{a}o c?n ch?c n\u{a}ng c?a n\'{o}. Cu?i c\`{u}ng, n?u b?n import th\^{o}ng qua m?t {\dj}u?ng d?n, ch?ng h?n nhu nh?p kh?u A = B.C, th\`{i} {\dj}i?u n\`{a}y t?o ra s? ph? thu?c c?a A tr\^{e}n B, v\`{i} ch\'{u}ng ta c?n ph?i bi?t B l\`{a} g\`{i} (n\'{o} l\`{a} tr?u tu?ng hay g\`{i}).

\begin{enumerate}
\item  Name Resolution\underbar{}
\end{enumerate}

\noindent (Todo: Nh?ng {\dj}i?u sau {\dj}\^{a}y {\dj}\~{a} thay {\dj}?i trong Dafny. M\^{o} t? ? {\dj}\^{a}y n\^{e}n {\dj}u?c thay {\dj}?i {\dj}? ph?n \'{a}nh c\'{a}c quy t?c m?i.)

Khi Dafny nh\`{i}n th?y m?t c\'{a}i g\`{i} {\dj}\'{o} gi?ng nhu A.B.C, l\`{a}m th? n\`{a}o n\'{o} bi?t nh?ng g\`{i} t?ng ph?n {\dj}? c?p {\dj}?n? Quy tr\`{i}nh Dafny s? d?ng {\dj}? x\'{a}c {\dj}?nh tr\`{i}nh t? nh?n d?ng n\`{a}o nhu th? n\`{a}y {\dj}? c?p {\dj}?n vi?c ph\^{a}n gi?i t\^{e}n. M?c d\`{u} c\'{a}c quy t?c c\'{o} v? ph?c t?p, thu?ng th\`{i} h? l\`{a}m nh?ng g\`{i} b?n mong {\dj}?i. Dafny {\dj}?u ti\^{e}n t\`{i}m ki?m nh?n d?ng ban {\dj}?u. T\`{u}y thu?c v\`{a}o nh?ng g\`{i} nh?n di?n {\dj}?u ti\^{e}n {\dj}? c?p {\dj}?n, ph?n c\`{o}n l?i c?a {\dj}?nh danh {\dj}u?c tra c?u trong ng? c?nh th\'{i}ch h?p. C\'{a}c quy t?c {\dj}?y {\dj}? nhu sau:

\noindent 

C\'{a}c bi?n {\dj}?a phuong, c\'{a}c tham s? v\`{a} c\'{a}c bi?n r\`{a}ng bu?c. {\DJ}\^{a}y l\`{a} nh?ng th? nhu x, y, v\`{a} i trong var x ;, ... returns (y: int), v\`{a} forall i :: ....

C\'{a}c l?p, ki?u d? li?u, v\`{a} t\^{e}n m\^{o} {\dj}un ({\dj}u?c cung c?p {\dj}\^{a}y kh\^{o}ng ph?i l\`{a} ch? m?t ph?n c?a {\dj}?nh danh). L?p cho ph\'{e}p c\'{a}c th\`{a}nh vi\^{e}n t\~{i}nh c?a ch\'{u}ng {\dj}u?c truy c?p theo c\'{a}ch n\`{a}y, v\`{a} c\'{a}c lo?i d? li?u cho ph\'{e}p c\'{a}c nh\`{a} th?u c?a h? {\dj}u?c truy c?p. C\'{a}c m\^{o}-{\dj}un cho ph\'{e}p b?t k? th\`{a}nh vi\^{e}n n\`{a}o c?a h? {\dj}u?c g?i nhu th? n\`{a}y

T\^{e}n ngu?i x\^{a}y d?ng (n?u kh\^{o}ng r\~{o} r\`{a}ng). B?t k? lo?i d? li?u n\`{a}o c\~{u}ng kh\^{o}ng c?n ch?ng ch? (do {\dj}\'{o}, t\^{e}n ki?u d? li?u t? n\'{o} kh\^{o}ng c?n ti?n t?), v\`{a} c\~{u}ng c\'{o} m?t constructor {\dj}u?c {\dj}?t t\^{e}n duy nh?t, c\'{o} th? {\dj}u?c ch? d?n b?ng t\^{e}n c?a n\'{o}. V\`{i} v?y, n?u datatype List = Nhu?c {\dj}i?m (Danh s\'{a}ch) {\textbar} Nil l\`{a} lo?i d? li?u duy nh?t tuy\^{e}n b? c\'{a}c nh\`{a} x\^{a}y d?ng Cons v\`{a} Nil, sau {\dj}\'{o} b?n c\'{o} th? vi?t Cons (Nil). N?u t\^{e}n constructor kh\^{o}ng ph?i l\`{a} duy nh?t, th\`{i} b?n c?n ph?i th\^{e}m ti?n t? v\`{a}o t\^{e}n c?a ki?u d? li?u (v\'{i} d? List.Cons (List.Nil))). {\DJ}i?u n\`{a}y {\dj}u?c th?c hi?n cho m?i nh\`{a} x\^{a}y d?ng, kh\^{o}ng ph?i cho m?i lo?i d? li?u.

C\'{a}c tru?ng, c\'{a}c ch?c n\u{a}ng v\`{a} c\'{a}c phuong th?c c?a l?p hi?n t?i (n?u trong m?t ng? c?nh t\~{i}nh, th\`{i} ch? cho ph\'{e}p c\'{a}c phuong th?c v\`{a} h\`{a}m t\~{i}nh). B?n c\'{o} th? tham kh?o c\'{a}c tru?ng c?a l?p hi?n t?i ho?c nhu this.f ho?c f, gi? {\dj}?nh r?ng t?t nhi\^{e}n l\`{a} f {\dj}\~{a} kh\^{o}ng {\dj}u?c ?n b?i m?t trong nh?ng ? tr\^{e}n. B?n c\'{o} th? lu\^{o}n lu\^{o}n ti?n t? n\`{a}y n?u c?n, m\`{a} kh\^{o}ng th? {\dj}u?c ?n. (Luu \'{y}, m?t tru?ng c\'{o} t\^{e}n l\`{a} m?t chu?i s? ph?i lu\^{o}n c\'{o} m?t s? ti?n t?.)

\noindent C\'{a}c h\`{a}m v\`{a} phuong th?c t\~{i}nh trong m\^{o}-{\dj}un bao b?c. Luu \'{y}, {\dj}i?u n\`{a}y ch? {\dj}? c?p {\dj}?n c\'{a}c h\`{a}m v\`{a} phuong th?c khai b\'{a}o ? c?p m\^{o} {\dj}un, ch? kh\^{o}ng ph?i c\'{a}c th\`{a}nh vi\^{e}n t\~{i}nh c?a m?t l?p {\dj}u?c {\dj}?t t\^{e}n.

\noindent M\^{o}{\dj}un {\dj}\~{a} m? {\dj}u?c x? l\'{y} ? m?i c?p {\dj}?, sau khi c\'{a}c t? khai trong m\^{o} {\dj}un hi?n t?i. M\^{o} {\dj}un {\dj}\~{a} m? ch? ?nh hu?ng {\dj}?n c\'{a}c bu?c 2, 3 v\`{a} 5. N?u m?t t\^{e}n mo h? {\dj}u?c t\`{i}m th?y, m?t l?i {\dj}u?c t?o ra, thay v\`{i} ti?p t?c xu?ng danh s\'{a}ch. Sau khi nh?n d?ng {\dj}?u ti\^{e}n, c\'{a}c quy t?c v? co b?n l\`{a} gi?ng nhau, ngo?i tr? trong b?i c?nh m?i. V\'{i} d?: n?u {\dj}?nh danh {\dj}?u ti\^{e}n l\`{a} m?t m\^{o}-{\dj}un, th\`{i} {\dj}?nh danh ti?p theo s? xem x\'{e}t m\^{o}-{\dj}un {\dj}\'{o}. M\^{o}-{\dj}un m? ch? {\dj}u?c \'{a}p d?ng trong m\^{o}-{\dj}un {\dj}u?c m? ra. Khi t\`{i}m ki?m trong m\^{o}-{\dj}un kh\'{a}c, ch? nh?ng {\dj}i?u {\dj}u?c tuy\^{e}n b? r\~{o} r\`{a}ng trong m\^{o}-{\dj}un {\dj}\'{o} {\dj}u?c xem x\'{e}t.

\noindent \textbf{}

\noindent 

\noindent 


\end{document}

